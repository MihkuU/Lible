#include <lible/ints/spherical_trafo.hpp>
#include <lible/ints/defs.hpp>
#include <lible/ints/utils.hpp>

#include <cassert>
#include <stdexcept>

namespace LI = lible::ints;

using std::tuple, std::vector;

vector<tuple<int, int, double>> LI::sphericalTrafo(const int l)
{
    switch (l)
    {
    case (0):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 0, 1.00000000000000}};

        return trafo;
    }
    case (1):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 2, 1.00000000000000},
            {1, 0, 1.00000000000000},
            {2, 1, 1.00000000000000}};

        return trafo;
    }
    case (2):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 0, -0.50000000000000},
            {0, 3, -0.50000000000000},
            {0, 5, 1.00000000000000},
            {1, 2, 1.73205080756888},
            {2, 4, 1.73205080756888},
            {3, 0, 0.86602540378444},
            {3, 3, -0.86602540378444},
            {4, 1, 1.73205080756888}};

        return trafo;
    }
    case (3):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 2, -1.50000000000000},
            {0, 7, -1.50000000000000},
            {0, 9, 1.00000000000000},
            {1, 0, -0.61237243569579},
            {1, 3, -0.61237243569579},
            {1, 5, 2.44948974278318},
            {2, 1, -0.61237243569579},
            {2, 6, -0.61237243569579},
            {2, 8, 2.44948974278318},
            {3, 2, 1.93649167310371},
            {3, 7, -1.93649167310371},
            {4, 4, 3.87298334620742},
            {5, 0, 0.79056941504209},
            {5, 3, -2.37170824512628},
            {6, 1, 2.37170824512628},
            {6, 6, -0.79056941504209}};

        return trafo;
    }
    case (4):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 0, 0.37500000000000},
            {0, 3, 0.75000000000000},
            {0, 5, -3.00000000000000},
            {0, 10, 0.37500000000000},
            {0, 12, -3.00000000000000},
            {0, 14, 1.00000000000000},
            {1, 2, -2.37170824512628},
            {1, 7, -2.37170824512628},
            {1, 9, 3.16227766016838},
            {2, 4, -2.37170824512628},
            {2, 11, -2.37170824512628},
            {2, 13, 3.16227766016838},
            {3, 0, -0.55901699437495},
            {3, 5, 3.35410196624968},
            {3, 10, 0.55901699437495},
            {3, 12, -3.35410196624968},
            {4, 1, -1.11803398874989},
            {4, 6, -1.11803398874989},
            {4, 8, 6.70820393249937},
            {5, 2, 2.09165006633519},
            {5, 7, -6.27495019900557},
            {6, 4, 6.27495019900557},
            {6, 11, -2.09165006633519},
            {7, 0, 0.73950997288745},
            {7, 3, -4.43705983732471},
            {7, 10, 0.73950997288745},
            {8, 1, 2.95803989154981},
            {8, 6, -2.95803989154981}};

        return trafo;
    }
    case (5):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 2, 1.87500000000000},
            {0, 7, 3.75000000000000},
            {0, 9, -5.00000000000000},
            {0, 16, 1.87500000000000},
            {0, 18, -5.00000000000000},
            {0, 20, 1.00000000000000},
            {1, 0, 0.48412291827593},
            {1, 3, 0.96824583655185},
            {1, 5, -5.80947501931113},
            {1, 10, 0.48412291827593},
            {1, 12, -5.80947501931113},
            {1, 14, 3.87298334620742},
            {2, 1, 0.48412291827593},
            {2, 6, 0.96824583655185},
            {2, 8, -5.80947501931113},
            {2, 15, 0.48412291827593},
            {2, 17, -5.80947501931113},
            {2, 19, 3.87298334620742},
            {3, 2, -2.56173769148990},
            {3, 9, 5.12347538297980},
            {3, 16, 2.56173769148990},
            {3, 18, -5.12347538297980},
            {4, 4, -5.12347538297980},
            {4, 11, -5.12347538297980},
            {4, 13, 10.24695076595960},
            {5, 0, -0.52291251658380},
            {5, 3, 1.04582503316759},
            {5, 5, 4.18330013267038},
            {5, 10, 1.56873754975139},
            {5, 12, -12.54990039801113},
            {6, 1, -1.56873754975139},
            {6, 6, -1.04582503316759},
            {6, 8, 12.54990039801113},
            {6, 15, 0.52291251658380},
            {6, 17, -4.18330013267038},
            {7, 2, 2.21852991866236},
            {7, 7, -13.31117951197414},
            {7, 16, 2.21852991866236},
            {8, 4, 8.87411967464942},
            {8, 11, -8.87411967464942},
            {9, 0, 0.70156076002011},
            {9, 3, -7.01560760020114},
            {9, 10, 3.50780380010057},
            {10, 1, 3.50780380010057},
            {10, 6, -7.01560760020114},
            {10, 15, 0.70156076002011}};

        return trafo;
    }
    case (6):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 0, -0.31250000000000},
            {0, 3, -0.93750000000000},
            {0, 5, 5.62500000000000},
            {0, 10, -0.93750000000000},
            {0, 12, 11.25000000000000},
            {0, 14, -7.50000000000000},
            {0, 21, -0.31250000000000},
            {0, 23, 5.62500000000000},
            {0, 25, -7.50000000000000},
            {0, 27, 1.00000000000000},
            {1, 2, 2.86410980934740},
            {1, 7, 5.72821961869480},
            {1, 9, -11.45643923738960},
            {1, 16, 2.86410980934740},
            {1, 18, -11.45643923738960},
            {1, 20, 4.58257569495584},
            {2, 4, 2.86410980934740},
            {2, 11, 5.72821961869480},
            {2, 13, -11.45643923738960},
            {2, 22, 2.86410980934740},
            {2, 24, -11.45643923738960},
            {2, 26, 4.58257569495584},
            {3, 0, 0.45285552331842},
            {3, 3, 0.45285552331842},
            {3, 5, -7.24568837309472},
            {3, 10, -0.45285552331842},
            {3, 14, 7.24568837309472},
            {3, 21, -0.45285552331842},
            {3, 23, 7.24568837309472},
            {3, 25, -7.24568837309472},
            {4, 1, 0.90571104663684},
            {4, 6, 1.81142209327368},
            {4, 8, -14.49137674618944},
            {4, 15, 0.90571104663684},
            {4, 17, -14.49137674618944},
            {4, 19, 14.49137674618944},
            {5, 2, -2.71713313991052},
            {5, 7, 5.43426627982104},
            {5, 9, 7.24568837309472},
            {5, 16, 8.15139941973156},
            {5, 18, -21.73706511928416},
            {6, 4, -8.15139941973156},
            {6, 11, -5.43426627982104},
            {6, 13, 21.73706511928416},
            {6, 22, 2.71713313991052},
            {6, 24, -7.24568837309472},
            {7, 0, -0.49607837082461},
            {7, 3, 2.48039185412305},
            {7, 5, 4.96078370824611},
            {7, 10, 2.48039185412305},
            {7, 12, -29.76470224947665},
            {7, 21, -0.49607837082461},
            {7, 23, 4.96078370824611},
            {8, 1, -1.98431348329844},
            {8, 8, 19.84313483298443},
            {8, 15, 1.98431348329844},
            {8, 17, -19.84313483298443},
            {9, 2, 2.32681380862329},
            {9, 7, -23.26813808623286},
            {9, 16, 11.63406904311643},
            {10, 4, 11.63406904311643},
            {10, 11, -23.26813808623286},
            {10, 22, 2.32681380862329},
            {11, 0, 0.67169328938140},
            {11, 3, -10.07539934072094},
            {11, 10, 10.07539934072094},
            {11, 21, -0.67169328938140},
            {12, 1, 4.03015973628838},
            {12, 6, -13.43386578762792},
            {12, 15, 4.03015973628838}};

        return trafo;
    }
    case (7):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 2, -2.18750000000000},
            {0, 7, -6.56250000000000},
            {0, 9, 13.12500000000000},
            {0, 16, -6.56250000000000},
            {0, 18, 26.25000000000000},
            {0, 20, -10.50000000000000},
            {0, 29, -2.18750000000000},
            {0, 31, 13.12500000000000},
            {0, 33, -10.50000000000000},
            {0, 35, 1.00000000000000},
            {1, 0, -0.41339864235384},
            {1, 3, -1.24019592706153},
            {1, 5, 9.92156741649221},
            {1, 10, -1.24019592706153},
            {1, 12, 19.84313483298443},
            {1, 14, -19.84313483298443},
            {1, 21, -0.41339864235384},
            {1, 23, 9.92156741649221},
            {1, 25, -19.84313483298443},
            {1, 27, 5.29150262212918},
            {2, 1, -0.41339864235384},
            {2, 6, -1.24019592706153},
            {2, 8, 9.92156741649221},
            {2, 15, -1.24019592706153},
            {2, 17, 19.84313483298443},
            {2, 19, -19.84313483298443},
            {2, 28, -0.41339864235384},
            {2, 30, 9.92156741649221},
            {2, 32, -19.84313483298443},
            {2, 34, 5.29150262212918},
            {3, 2, 3.03784720237868},
            {3, 7, 3.03784720237868},
            {3, 9, -16.20185174601965},
            {3, 16, -3.03784720237868},
            {3, 20, 9.72111104761179},
            {3, 29, -3.03784720237868},
            {3, 31, 16.20185174601965},
            {3, 33, -9.72111104761179},
            {4, 4, 6.07569440475737},
            {4, 11, 12.15138880951474},
            {4, 13, -32.40370349203930},
            {4, 22, 6.07569440475737},
            {4, 24, -32.40370349203930},
            {4, 26, 19.44222209522358},
            {5, 0, 0.42961647140211},
            {5, 3, -0.42961647140211},
            {5, 5, -8.59232942804220},
            {5, 10, -2.14808235701055},
            {5, 12, 17.18465885608440},
            {5, 14, 11.45643923738960},
            {5, 21, -1.28884941420633},
            {5, 23, 25.77698828412660},
            {5, 25, -34.36931771216879},
            {6, 1, 1.28884941420633},
            {6, 6, 2.14808235701055},
            {6, 8, -25.77698828412660},
            {6, 15, 0.42961647140211},
            {6, 17, -17.18465885608440},
            {6, 19, 34.36931771216879},
            {6, 28, -0.42961647140211},
            {6, 30, 8.59232942804220},
            {6, 32, -11.45643923738960},
            {7, 2, -2.84975327879450},
            {7, 7, 14.24876639397250},
            {7, 9, 9.49917759598167},
            {7, 16, 14.24876639397250},
            {7, 18, -56.99506557588999},
            {7, 29, -2.84975327879450},
            {7, 31, 9.49917759598167},
            {8, 4, -11.39901311517800},
            {8, 13, 37.99671038392666},
            {8, 22, 11.39901311517800},
            {8, 24, -37.99671038392666},
            {9, 0, -0.47495887979908},
            {9, 3, 4.27462991819175},
            {9, 5, 5.69950655758900},
            {9, 10, 2.37479439899542},
            {9, 12, -56.99506557588999},
            {9, 21, -2.37479439899542},
            {9, 23, 28.49753278794499},
            {10, 1, -2.37479439899542},
            {10, 6, 2.37479439899542},
            {10, 8, 28.49753278794499},
            {10, 15, 4.27462991819175},
            {10, 17, -56.99506557588999},
            {10, 28, -0.47495887979908},
            {10, 30, 5.69950655758900},
            {11, 2, 2.42182459624970},
            {11, 7, -36.32736894374543},
            {11, 16, 36.32736894374543},
            {11, 29, -2.42182459624970},
            {12, 4, 14.53094757749817},
            {12, 11, -48.43649192499390},
            {12, 22, 14.53094757749817},
            {13, 0, 0.64725984928775},
            {13, 3, -13.59245683504274},
            {13, 10, 22.65409472507123},
            {13, 21, -4.53081894501425},
            {14, 1, 4.53081894501425},
            {14, 6, -22.65409472507123},
            {14, 15, 13.59245683504274},
            {14, 28, -0.64725984928775}};

        return trafo;
    }
    case (8):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 0, 0.27343750000000},
            {0, 3, 1.09375000000000},
            {0, 5, -8.75000000000000},
            {0, 10, 1.64062500000000},
            {0, 12, -26.25000000000000},
            {0, 14, 26.25000000000000},
            {0, 21, 1.09375000000000},
            {0, 23, -26.25000000000000},
            {0, 25, 52.50000000000000},
            {0, 27, -14.00000000000000},
            {0, 36, 0.27343750000000},
            {0, 38, -8.75000000000000},
            {0, 40, 26.25000000000000},
            {0, 42, -14.00000000000000},
            {0, 44, 1.00000000000000},
            {1, 2, -3.28125000000000},
            {1, 7, -9.84375000000000},
            {1, 9, 26.25000000000000},
            {1, 16, -9.84375000000000},
            {1, 18, 52.50000000000000},
            {1, 20, -31.50000000000000},
            {1, 29, -3.28125000000000},
            {1, 31, 26.25000000000000},
            {1, 33, -31.50000000000000},
            {1, 35, 6.00000000000000},
            {2, 4, -3.28125000000000},
            {2, 11, -9.84375000000000},
            {2, 13, 26.25000000000000},
            {2, 22, -9.84375000000000},
            {2, 24, 52.50000000000000},
            {2, 26, -31.50000000000000},
            {2, 37, -3.28125000000000},
            {2, 39, 26.25000000000000},
            {2, 41, -31.50000000000000},
            {2, 43, 6.00000000000000},
            {3, 0, -0.39218438743785},
            {3, 3, -0.78436877487570},
            {3, 5, 11.76553162313544},
            {3, 12, 11.76553162313544},
            {3, 14, -31.37475099502783},
            {3, 21, 0.78436877487570},
            {3, 23, -11.76553162313544},
            {3, 27, 12.54990039801113},
            {3, 36, 0.39218438743785},
            {3, 38, -11.76553162313544},
            {3, 40, 31.37475099502783},
            {3, 42, -12.54990039801113},
            {4, 1, -0.78436877487570},
            {4, 6, -2.35310632462709},
            {4, 8, 23.53106324627088},
            {4, 15, -2.35310632462709},
            {4, 17, 47.06212649254175},
            {4, 19, -62.74950199005566},
            {4, 28, -0.78436877487570},
            {4, 30, 23.53106324627088},
            {4, 32, -62.74950199005566},
            {4, 34, 25.09980079602227},
            {5, 2, 3.18612102524371},
            {5, 7, -3.18612102524370},
            {5, 9, -21.24080683495804},
            {5, 16, -15.93060512621853},
            {5, 18, 42.48161366991607},
            {5, 20, 16.99264546796643},
            {5, 29, -9.55836307573112},
            {5, 31, 63.72242050487411},
            {5, 33, -50.97793640389929},
            {6, 4, 9.55836307573112},
            {6, 11, 15.93060512621853},
            {6, 13, -63.72242050487411},
            {6, 22, 3.18612102524370},
            {6, 24, -42.48161366991607},
            {6, 26, 50.97793640389929},
            {6, 37, -3.18612102524371},
            {6, 39, 21.24080683495804},
            {6, 41, -16.99264546796643},
            {7, 0, 0.41132645565901},
            {7, 3, -1.64530582263602},
            {7, 5, -9.87183493581614},
            {7, 10, -4.11326455659006},
            {7, 12, 49.35917467908068},
            {7, 14, 16.45305822636023},
            {7, 21, -1.64530582263602},
            {7, 23, 49.35917467908068},
            {7, 25, -98.71834935816138},
            {7, 36, 0.41132645565901},
            {7, 38, -9.87183493581614},
            {7, 40, 16.45305822636023},
            {8, 1, 1.64530582263602},
            {8, 6, 1.64530582263602},
            {8, 8, -39.48733974326455},
            {8, 15, -1.64530582263602},
            {8, 19, 65.81223290544091},
            {8, 28, -1.64530582263602},
            {8, 30, 39.48733974326455},
            {8, 32, -65.81223290544091},
            {9, 2, -2.96611725366682},
            {9, 7, 26.69505528300138},
            {9, 9, 11.86446901466728},
            {9, 16, 14.83058626833410},
            {9, 18, -118.64469014667280},
            {9, 29, -14.83058626833410},
            {9, 31, 59.32234507333640},
            {10, 4, -14.83058626833410},
            {10, 11, 14.83058626833410},
            {10, 13, 59.32234507333640},
            {10, 22, 26.69505528300138},
            {10, 24, -118.64469014667280},
            {10, 37, -2.96611725366682},
            {10, 39, 11.86446901466728},
            {11, 0, -0.45768182862115},
            {11, 3, 6.40754560069610},
            {11, 5, 6.40754560069610},
            {11, 12, -96.11318401044156},
            {11, 21, -6.40754560069610},
            {11, 23, 96.11318401044156},
            {11, 36, 0.45768182862115},
            {11, 38, -6.40754560069610},
            {12, 1, -2.74609097172690},
            {12, 6, 6.40754560069610},
            {12, 8, 38.44527360417662},
            {12, 15, 6.40754560069610},
            {12, 17, -128.15091201392207},
            {12, 28, -2.74609097172690},
            {12, 30, 38.44527360417662},
            {13, 2, 2.50682661696018},
            {13, 7, -52.64335895616369},
            {13, 16, 87.73893159360614},
            {13, 29, -17.54778631872123},
            {14, 4, 17.54778631872123},
            {14, 11, -87.73893159360614},
            {14, 22, 52.64335895616369},
            {14, 37, -2.50682661696018},
            {15, 0, 0.62670665424004},
            {15, 3, -17.54778631872123},
            {15, 10, 43.86946579680307},
            {15, 21, -17.54778631872123},
            {15, 36, 0.62670665424004},
            {16, 1, 5.01365323392035},
            {16, 6, -35.09557263744246},
            {16, 15, 35.09557263744246},
            {16, 28, -5.01365323392035}};

        return trafo;
    }
    case (9):
    {
        vector<tuple<int, int, double>> trafo{
            {0, 2, 2.46093750000000},
            {0, 7, 9.84375000000000},
            {0, 9, -26.25000000000000},
            {0, 16, 14.76562500000000},
            {0, 18, -78.75000000000000},
            {0, 20, 47.25000000000000},
            {0, 29, 9.84375000000000},
            {0, 31, -78.75000000000000},
            {0, 33, 94.50000000000000},
            {0, 35, -18.00000000000000},
            {0, 46, 2.46093750000000},
            {0, 48, -26.25000000000000},
            {0, 50, 47.25000000000000},
            {0, 52, -18.00000000000000},
            {0, 54, 1.00000000000000},
            {1, 0, 0.36685490255856},
            {1, 3, 1.46741961023424},
            {1, 5, -14.67419610234237},
            {1, 10, 2.20112941535136},
            {1, 12, -44.02258830702711},
            {1, 14, 58.69678440936949},
            {1, 21, 1.46741961023424},
            {1, 23, -44.02258830702711},
            {1, 25, 117.39356881873897},
            {1, 27, -46.95742752749559},
            {1, 36, 0.36685490255856},
            {1, 38, -14.67419610234237},
            {1, 40, 58.69678440936949},
            {1, 42, -46.95742752749559},
            {1, 44, 6.70820393249937},
            {2, 1, 0.36685490255856},
            {2, 6, 1.46741961023424},
            {2, 8, -14.67419610234237},
            {2, 15, 2.20112941535136},
            {2, 17, -44.02258830702711},
            {2, 19, 58.69678440936949},
            {2, 28, 1.46741961023424},
            {2, 30, -44.02258830702711},
            {2, 32, 117.39356881873897},
            {2, 34, -46.95742752749559},
            {2, 45, 0.36685490255856},
            {2, 47, -14.67419610234237},
            {2, 49, 58.69678440936949},
            {2, 51, -46.95742752749559},
            {2, 53, 6.70820393249937},
            {3, 2, -3.44140403305831},
            {3, 7, -6.88280806611662},
            {3, 9, 34.41404033058310},
            {3, 18, 34.41404033058310},
            {3, 20, -55.06246452893296},
            {3, 29, 6.88280806611662},
            {3, 31, -34.41404033058310},
            {3, 35, 15.73213272255227},
            {3, 46, 3.44140403305831},
            {3, 48, -34.41404033058310},
            {3, 50, 55.06246452893296},
            {3, 52, -15.73213272255227},
            {4, 4, -6.88280806611662},
            {4, 11, -20.64842419834986},
            {4, 13, 68.82808066116620},
            {4, 22, -20.64842419834986},
            {4, 24, 137.65616132233239},
            {4, 26, -110.12492905786593},
            {4, 37, -6.88280806611662},
            {4, 39, 68.82808066116620},
            {4, 41, -110.12492905786593},
            {4, 43, 31.46426544510455},
            {5, 0, -0.37548796377181},
            {5, 5, 13.51756669578516},
            {5, 10, 2.25292778263086},
            {5, 12, -13.51756669578516},
            {5, 14, -45.05855565261719},
            {5, 21, 3.00390371017448},
            {5, 23, -67.58783347892577},
            {5, 25, 90.11711130523439},
            {5, 27, 24.03122968139584},
            {5, 36, 1.12646389131543},
            {5, 38, -40.55270008735547},
            {5, 40, 135.17566695785158},
            {5, 42, -72.09368904418750},
            {6, 1, -1.12646389131543},
            {6, 6, -3.00390371017448},
            {6, 8, 40.55270008735547},
            {6, 15, -2.25292778263086},
            {6, 17, 67.58783347892577},
            {6, 19, -135.17566695785158},
            {6, 30, 13.51756669578516},
            {6, 32, -90.11711130523439},
            {6, 34, 72.09368904418750},
            {6, 45, 0.37548796377181},
            {6, 47, -13.51756669578516},
            {6, 49, 45.05855565261719},
            {6, 51, -24.03122968139584},
            {7, 2, 3.31621990421700},
            {7, 7, -13.26487961686800},
            {7, 9, -26.52975923373599},
            {7, 16, -33.16219904216999},
            {7, 18, 132.64879616867995},
            {7, 20, 26.52975923373599},
            {7, 29, -13.26487961686800},
            {7, 31, 132.64879616867995},
            {7, 33, -159.17855540241595},
            {7, 46, 3.31621990421700},
            {7, 48, -26.52975923373599},
            {7, 50, 26.52975923373599},
            {8, 4, 13.26487961686800},
            {8, 11, 13.26487961686800},
            {8, 13, -106.11903693494396},
            {8, 22, -13.26487961686800},
            {8, 26, 106.11903693494396},
            {8, 37, -13.26487961686800},
            {8, 39, 106.11903693494396},
            {8, 41, -106.11903693494396},
            {9, 0, 0.39636409043643},
            {9, 3, -3.17091272349146},
            {9, 5, -11.09819453222009},
            {9, 10, -5.54909726611005},
            {9, 12, 99.88375078998087},
            {9, 14, 22.19638906444019},
            {9, 23, 55.49097266110048},
            {9, 25, -221.96389064440191},
            {9, 36, 1.98182045218216},
            {9, 38, -55.49097266110048},
            {9, 40, 110.98194532220096},
            {10, 1, 1.98182045218216},
            {10, 8, -55.49097266110048},
            {10, 15, -5.54909726611005},
            {10, 17, 55.49097266110048},
            {10, 19, 110.98194532220096},
            {10, 28, -3.17091272349146},
            {10, 30, 99.88375078998087},
            {10, 32, -221.96389064440191},
            {10, 45, 0.39636409043643},
            {10, 47, -11.09819453222009},
            {10, 49, 22.19638906444019},
            {11, 2, -3.07022304258990},
            {11, 7, 42.98312259625865},
            {11, 9, 14.32770753208622},
            {11, 18, -214.91561298129324},
            {11, 29, -42.98312259625865},
            {11, 31, 214.91561298129324},
            {11, 46, 3.07022304258990},
            {11, 48, -14.32770753208622},
            {12, 4, -18.42133825553942},
            {12, 11, 42.98312259625864},
            {12, 13, 85.96624519251729},
            {12, 22, 42.98312259625864},
            {12, 24, -286.55415064172428},
            {12, 37, -18.42133825553942},
            {12, 39, 85.96624519251729},
            {13, 0, -0.44314852502787},
            {13, 3, 8.86297050055736},
            {13, 5, 7.09037640044589},
            {13, 10, -6.20407935039015},
            {13, 12, -148.89790440936369},
            {13, 21, -12.40815870078031},
            {13, 23, 248.16317401560616},
            {13, 36, 3.10203967519508},
            {13, 38, -49.63263480312123},
            {14, 1, -3.10203967519508},
            {14, 6, 12.40815870078031},
            {14, 8, 49.63263480312123},
            {14, 15, 6.20407935039015},
            {14, 17, -248.16317401560616},
            {14, 28, -8.86297050055736},
            {14, 30, 148.89790440936369},
            {14, 45, 0.44314852502787},
            {14, 47, -7.09037640044589},
            {15, 2, 2.58397773170915},
            {15, 7, -72.35137648785613},
            {15, 16, 180.87844121964034},
            {15, 29, -72.35137648785613},
            {15, 46, 2.58397773170915},
            {16, 4, 20.67182185367318},
            {16, 11, -144.70275297571226},
            {16, 22, 144.70275297571226},
            {16, 37, -20.67182185367318},
            {17, 0, 0.60904939217552},
            {17, 3, -21.92577811831886},
            {17, 10, 76.74022341411600},
            {17, 21, -51.16014894274400},
            {17, 36, 5.48144452957971},
            {18, 1, 5.48144452957971},
            {18, 6, -51.16014894274400},
            {18, 15, 76.74022341411600},
            {18, 28, -21.92577811831886},
            {18, 45, 0.60904939217552}};

        return trafo;
    }
    default:
    {
        throw std::runtime_error("Inappropriate angular momentum given!\n");
    }
    }
}

// vector<tuple<int, int, double>> LI::sphericalTrafo(const int l)
// {
//     arma::dmat sph_trafo_mat = returnSphericalTrafo(l);

//     vector<tuple<int, int, double>> sph_trafo;
//     for (size_t i = 0; i < sph_trafo_mat.n_rows; i++)
//         for (size_t j = 0; j < sph_trafo_mat.n_cols; j++)
//         {
//             double val = sph_trafo_mat(i, j);
//             if (std::fabs(val) != 0)
//                 sph_trafo.push_back({i, j, val});
//         }

//     return sph_trafo;
// }

lible::vec2d LI::trafo2Spherical(const int la, const int lb, const vec2d &ints_cart)
{
    int n_cart_a = numCartesians(la);
    int n_sph_a = numSphericals(la);
    int n_sph_b = numSphericals(lb);

    vector<tuple<int, int, double>> trafo_a = sphericalTrafo(la);
    vector<tuple<int, int, double>> trafo_b = sphericalTrafo(lb);

    vec2d ints_cart_sph(n_cart_a, n_sph_b, 0);
    for (int ia = 0; ia < n_cart_a; ia++)
        for (auto &[isph, icart, val] : trafo_b)
            ints_cart_sph(ia, isph) += val * ints_cart(ia, icart);

    vec2d ints_out(n_sph_a, n_sph_b, 0);
    for (int ib = 0; ib < n_sph_b; ib++)
        for (auto &[isph, icart, val] : trafo_a)
            ints_out(isph, ib) += val * ints_cart_sph(icart, ib);

    return ints_out;
}