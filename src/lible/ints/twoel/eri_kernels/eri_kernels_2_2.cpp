#include <lible/ints/twoel/eri_kernels.hpp>

template<> void lible::ints::two::eri4Kernel<1, 1, 1, 1>(const int cdepth_a, const int cdepth_b,
                                                         const int cdepth_c, const int cdepth_d,
                                                         const double *exps_a, const double *exps_b,
                                                         const double *exps_c, const double *exps_d,
                                                         const double *coords_a, const double *coords_b,
                                                         const double *coords_c, const double *coords_d,
                                                         const double *ecoeffs_ab, const double *ecoeffs_cd_tsp,
                                                         double *eri4_batch)
{
    constexpr int la = 1, lb = 1, lc = 1, ld = 1;
    constexpr int lab = la + lb;
    constexpr int lcd = lc + ld;
    constexpr int labcd = lab + lcd;

    constexpr int n_sph_a = numSphericalsC(la);
    constexpr int n_sph_b = numSphericalsC(lb);
    constexpr int n_sph_c = numSphericalsC(lc);
    constexpr int n_sph_d = numSphericalsC(ld);
    constexpr int n_hermite_ab = numHermitesC(lab);
    constexpr int n_hermite_cd = numHermitesC(lcd);
    constexpr int n_sph_ab = n_sph_a * n_sph_b;
    constexpr int n_sph_cd = n_sph_c * n_sph_d;
    constexpr int n_ecoeffs_ab = n_sph_ab * n_hermite_ab;

    constexpr int n_ecoeffs_cd = n_sph_cd * n_hermite_cd;

    std::fill(eri4_batch, eri4_batch + n_sph_ab * n_sph_cd, 0);

    std::array<double, labcd + 1> fnx;
    BoysF2<labcd> boys_f;

    constexpr int n_hermites_abcd = numHermitesC(lab) * numHermitesC(lcd);
    std::array<double, n_hermites_abcd> rints;

    constexpr int n_rints_x_ecoeffs = n_sph_cd * n_hermite_ab;
    std::vector<double> rints_x_ecoeffs(cdepth_a * cdepth_b * n_rints_x_ecoeffs, 0);

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            int pos_rints_x_ecoeffs = iab * n_rints_x_ecoeffs;
            for (int ic = 0, icd = 0; ic < cdepth_c; ic++)
                for (int id = 0; id < cdepth_d; id++, icd++)
                {
                    double a = exps_a[ia];
                    double b = exps_b[ib];
                    double c = exps_c[ic];
                    double d = exps_d[id];
                    double p = a + b;
                    double q = c + d;
                    std::array<double, 3> xyz_p{(a * coords_a[0] + b * coords_b[0]) / p,
                                                (a * coords_a[1] + b * coords_b[1]) / p,
                                                (a * coords_a[2] + b * coords_b[2]) / p};

                    std::array<double, 3> xyz_q{(c * coords_c[0] + d * coords_d[0]) / q,
                                                (c * coords_c[1] + d * coords_d[1]) / q,
                                                (c * coords_c[2] + d * coords_d[2]) / q};

                    std::array<double, 3> xyz_pq{xyz_p[0] - xyz_q[0], xyz_p[1] - xyz_q[1],
                                                 xyz_p[2] - xyz_q[2]};

                    double alpha = p * q / (p + q);
                    double dx{xyz_pq[0]}, dy{xyz_pq[1]}, dz{xyz_pq[2]};
                    double x = alpha * (dx * dx + dy * dy + dz * dz);
                    boys_f.calcFnx(x, &fnx[0]);

                    double fac = (2.0 * std::pow(M_PI, 2.5) / (p * q * std::sqrt(p + q)));
                    calcRInts<lab, lcd>(alpha, fac, &fnx[0], &xyz_pq[0], &rints[0]);

                    const double* p_ecoeffs_cd_tsp = &ecoeffs_cd_tsp[icd * n_ecoeffs_cd];
                    double* p_rints_x_ecoeffs = &rints_x_ecoeffs[pos_rints_x_ecoeffs];

                    p_rints_x_ecoeffs[0] += rints[0] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[0] += rints[3] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[0] += rints[9] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[1] += rints[1] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[1] += rints[0] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[1] += rints[3] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[1] += rints[6] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[2] += rints[0] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[2] += rints[3] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[2] += rints[2] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[2] += rints[8] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[3] += rints[1] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[3] += rints[0] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[3] += rints[3] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[3] += rints[6] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[4] += rints[1] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[4] += rints[0] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[4] += rints[4] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[5] += rints[1] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[5] += rints[0] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[5] += rints[5] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[5] += rints[2] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[6] += rints[0] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[6] += rints[3] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[6] += rints[2] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[6] += rints[8] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[7] += rints[1] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[7] += rints[0] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[7] += rints[5] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[7] += rints[2] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[8] += rints[7] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[8] += rints[0] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[8] += rints[2] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[9] += rints[10] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[9] += rints[13] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[9] += rints[19] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[10] += rints[11] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[10] += rints[10] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[10] += rints[13] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[10] += rints[16] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[11] += rints[10] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[11] += rints[13] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[11] += rints[12] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[11] += rints[18] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[12] += rints[11] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[12] += rints[10] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[12] += rints[13] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[12] += rints[16] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[13] += rints[11] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[13] += rints[10] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[13] += rints[14] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[14] += rints[11] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[14] += rints[10] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[14] += rints[15] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[14] += rints[12] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[15] += rints[10] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[15] += rints[13] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[15] += rints[12] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[15] += rints[18] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[16] += rints[11] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[16] += rints[10] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[16] += rints[15] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[16] += rints[12] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[17] += rints[17] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[17] += rints[10] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[17] += rints[12] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[18] += rints[20] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[18] += rints[23] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[18] += rints[29] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[19] += rints[21] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[19] += rints[20] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[19] += rints[23] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[19] += rints[26] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[20] += rints[20] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[20] += rints[23] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[20] += rints[22] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[20] += rints[28] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[21] += rints[21] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[21] += rints[20] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[21] += rints[23] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[21] += rints[26] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[22] += rints[21] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[22] += rints[20] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[22] += rints[24] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[23] += rints[21] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[23] += rints[20] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[23] += rints[25] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[23] += rints[22] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[24] += rints[20] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[24] += rints[23] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[24] += rints[22] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[24] += rints[28] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[25] += rints[21] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[25] += rints[20] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[25] += rints[25] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[25] += rints[22] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[26] += rints[27] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[26] += rints[20] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[26] += rints[22] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[27] += rints[30] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[27] += rints[33] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[27] += rints[39] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[28] += rints[31] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[28] += rints[30] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[28] += rints[33] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[28] += rints[36] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[29] += rints[30] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[29] += rints[33] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[29] += rints[32] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[29] += rints[38] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[30] += rints[31] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[30] += rints[30] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[30] += rints[33] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[30] += rints[36] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[31] += rints[31] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[31] += rints[30] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[31] += rints[34] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[32] += rints[31] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[32] += rints[30] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[32] += rints[35] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[32] += rints[32] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[33] += rints[30] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[33] += rints[33] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[33] += rints[32] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[33] += rints[38] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[34] += rints[31] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[34] += rints[30] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[34] += rints[35] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[34] += rints[32] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[35] += rints[37] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[35] += rints[30] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[35] += rints[32] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[36] += rints[40] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[36] += rints[43] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[36] += rints[49] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[37] += rints[41] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[37] += rints[40] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[37] += rints[43] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[37] += rints[46] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[38] += rints[40] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[38] += rints[43] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[38] += rints[42] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[38] += rints[48] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[39] += rints[41] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[39] += rints[40] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[39] += rints[43] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[39] += rints[46] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[40] += rints[41] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[40] += rints[40] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[40] += rints[44] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[41] += rints[41] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[41] += rints[40] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[41] += rints[45] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[41] += rints[42] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[42] += rints[40] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[42] += rints[43] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[42] += rints[42] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[42] += rints[48] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[43] += rints[41] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[43] += rints[40] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[43] += rints[45] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[43] += rints[42] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[44] += rints[47] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[44] += rints[40] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[44] += rints[42] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[45] += rints[50] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[45] += rints[53] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[45] += rints[59] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[46] += rints[51] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[46] += rints[50] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[46] += rints[53] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[46] += rints[56] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[47] += rints[50] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[47] += rints[53] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[47] += rints[52] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[47] += rints[58] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[48] += rints[51] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[48] += rints[50] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[48] += rints[53] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[48] += rints[56] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[49] += rints[51] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[49] += rints[50] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[49] += rints[54] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[50] += rints[51] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[50] += rints[50] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[50] += rints[55] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[50] += rints[52] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[51] += rints[50] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[51] += rints[53] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[51] += rints[52] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[51] += rints[58] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[52] += rints[51] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[52] += rints[50] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[52] += rints[55] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[52] += rints[52] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[53] += rints[57] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[53] += rints[50] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[53] += rints[52] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[54] += rints[60] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[54] += rints[63] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[54] += rints[69] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[55] += rints[61] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[55] += rints[60] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[55] += rints[63] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[55] += rints[66] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[56] += rints[60] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[56] += rints[63] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[56] += rints[62] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[56] += rints[68] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[57] += rints[61] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[57] += rints[60] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[57] += rints[63] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[57] += rints[66] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[58] += rints[61] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[58] += rints[60] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[58] += rints[64] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[59] += rints[61] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[59] += rints[60] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[59] += rints[65] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[59] += rints[62] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[60] += rints[60] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[60] += rints[63] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[60] += rints[62] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[60] += rints[68] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[61] += rints[61] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[61] += rints[60] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[61] += rints[65] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[61] += rints[62] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[62] += rints[67] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[62] += rints[60] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[62] += rints[62] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[63] += rints[70] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[63] += rints[73] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[63] += rints[79] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[64] += rints[71] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[64] += rints[70] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[64] += rints[73] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[64] += rints[76] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[65] += rints[70] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[65] += rints[73] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[65] += rints[72] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[65] += rints[78] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[66] += rints[71] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[66] += rints[70] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[66] += rints[73] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[66] += rints[76] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[67] += rints[71] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[67] += rints[70] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[67] += rints[74] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[68] += rints[71] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[68] += rints[70] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[68] += rints[75] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[68] += rints[72] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[69] += rints[70] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[69] += rints[73] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[69] += rints[72] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[69] += rints[78] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[70] += rints[71] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[70] += rints[70] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[70] += rints[75] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[70] += rints[72] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[71] += rints[77] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[71] += rints[70] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[71] += rints[72] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[72] += rints[80] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[72] += rints[83] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[72] += rints[89] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[73] += rints[81] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[73] += rints[80] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[73] += rints[83] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[73] += rints[86] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[74] += rints[80] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[74] += rints[83] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[74] += rints[82] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[74] += rints[88] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[75] += rints[81] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[75] += rints[80] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[75] += rints[83] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[75] += rints[86] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[76] += rints[81] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[76] += rints[80] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[76] += rints[84] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[77] += rints[81] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[77] += rints[80] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[77] += rints[85] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[77] += rints[82] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[78] += rints[80] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[78] += rints[83] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[78] += rints[82] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[78] += rints[88] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[79] += rints[81] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[79] += rints[80] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[79] += rints[85] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[79] += rints[82] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[80] += rints[87] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[80] += rints[80] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[80] += rints[82] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[81] += rints[90] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[81] += rints[93] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[81] += rints[99] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[82] += rints[91] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[82] += rints[90] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[82] += rints[93] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[82] += rints[96] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[83] += rints[90] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[83] += rints[93] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[83] += rints[92] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[83] += rints[98] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[84] += rints[91] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[84] += rints[90] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[84] += rints[93] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[84] += rints[96] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[85] += rints[91] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[85] += rints[90] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[85] += rints[94] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[86] += rints[91] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[86] += rints[90] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[86] += rints[95] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[86] += rints[92] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[87] += rints[90] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[87] += rints[93] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[87] += rints[92] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[87] += rints[98] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[88] += rints[91] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[88] += rints[90] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[88] += rints[95] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[88] += rints[92] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[89] += rints[97] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[89] += rints[90] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[89] += rints[92] * p_ecoeffs_cd_tsp[26];
                }
        }

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            const double* p_ecoeffs_ab = &ecoeffs_ab[iab * n_ecoeffs_ab];
            const double* p_rints_x_ecoeffs = &rints_x_ecoeffs[iab * n_rints_x_ecoeffs];

            eri4_batch[0] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[0];
            eri4_batch[0] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[27];
            eri4_batch[0] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[81];
            eri4_batch[1] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[1];
            eri4_batch[1] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[28];
            eri4_batch[1] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[82];
            eri4_batch[2] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[2];
            eri4_batch[2] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[29];
            eri4_batch[2] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[83];
            eri4_batch[3] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[3];
            eri4_batch[3] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[30];
            eri4_batch[3] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[84];
            eri4_batch[4] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[4];
            eri4_batch[4] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[31];
            eri4_batch[4] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[85];
            eri4_batch[5] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[5];
            eri4_batch[5] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[32];
            eri4_batch[5] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[86];
            eri4_batch[6] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[6];
            eri4_batch[6] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[33];
            eri4_batch[6] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[87];
            eri4_batch[7] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[7];
            eri4_batch[7] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[34];
            eri4_batch[7] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[88];
            eri4_batch[8] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[8];
            eri4_batch[8] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[35];
            eri4_batch[8] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[89];
            eri4_batch[9] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[9];
            eri4_batch[9] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[0];
            eri4_batch[9] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[27];
            eri4_batch[9] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[54];
            eri4_batch[10] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[10];
            eri4_batch[10] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[1];
            eri4_batch[10] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[28];
            eri4_batch[10] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[55];
            eri4_batch[11] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[11];
            eri4_batch[11] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[2];
            eri4_batch[11] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[29];
            eri4_batch[11] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[56];
            eri4_batch[12] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[12];
            eri4_batch[12] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[3];
            eri4_batch[12] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[30];
            eri4_batch[12] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[57];
            eri4_batch[13] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[13];
            eri4_batch[13] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[4];
            eri4_batch[13] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[31];
            eri4_batch[13] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[58];
            eri4_batch[14] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[14];
            eri4_batch[14] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[5];
            eri4_batch[14] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[32];
            eri4_batch[14] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[59];
            eri4_batch[15] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[15];
            eri4_batch[15] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[6];
            eri4_batch[15] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[33];
            eri4_batch[15] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[60];
            eri4_batch[16] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[16];
            eri4_batch[16] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[7];
            eri4_batch[16] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[34];
            eri4_batch[16] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[61];
            eri4_batch[17] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[17];
            eri4_batch[17] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[8];
            eri4_batch[17] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[35];
            eri4_batch[17] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[62];
            eri4_batch[18] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[0];
            eri4_batch[18] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[27];
            eri4_batch[18] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[18];
            eri4_batch[18] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[72];
            eri4_batch[19] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[1];
            eri4_batch[19] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[28];
            eri4_batch[19] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[19];
            eri4_batch[19] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[73];
            eri4_batch[20] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[2];
            eri4_batch[20] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[29];
            eri4_batch[20] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[20];
            eri4_batch[20] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[74];
            eri4_batch[21] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[3];
            eri4_batch[21] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[30];
            eri4_batch[21] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[21];
            eri4_batch[21] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[75];
            eri4_batch[22] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[4];
            eri4_batch[22] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[31];
            eri4_batch[22] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[22];
            eri4_batch[22] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[76];
            eri4_batch[23] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[5];
            eri4_batch[23] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[32];
            eri4_batch[23] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[23];
            eri4_batch[23] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[77];
            eri4_batch[24] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[6];
            eri4_batch[24] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[33];
            eri4_batch[24] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[24];
            eri4_batch[24] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[78];
            eri4_batch[25] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[7];
            eri4_batch[25] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[34];
            eri4_batch[25] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[25];
            eri4_batch[25] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[79];
            eri4_batch[26] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[8];
            eri4_batch[26] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[35];
            eri4_batch[26] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[26];
            eri4_batch[26] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[80];
            eri4_batch[27] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[9];
            eri4_batch[27] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[0];
            eri4_batch[27] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[27];
            eri4_batch[27] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[54];
            eri4_batch[28] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[10];
            eri4_batch[28] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[1];
            eri4_batch[28] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[28];
            eri4_batch[28] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[55];
            eri4_batch[29] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[11];
            eri4_batch[29] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[2];
            eri4_batch[29] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[29];
            eri4_batch[29] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[56];
            eri4_batch[30] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[12];
            eri4_batch[30] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[3];
            eri4_batch[30] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[30];
            eri4_batch[30] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[57];
            eri4_batch[31] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[13];
            eri4_batch[31] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[4];
            eri4_batch[31] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[31];
            eri4_batch[31] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[58];
            eri4_batch[32] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[14];
            eri4_batch[32] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[5];
            eri4_batch[32] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[32];
            eri4_batch[32] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[59];
            eri4_batch[33] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[15];
            eri4_batch[33] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[6];
            eri4_batch[33] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[33];
            eri4_batch[33] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[60];
            eri4_batch[34] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[16];
            eri4_batch[34] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[7];
            eri4_batch[34] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[34];
            eri4_batch[34] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[61];
            eri4_batch[35] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[17];
            eri4_batch[35] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[8];
            eri4_batch[35] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[35];
            eri4_batch[35] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[62];
            eri4_batch[36] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[9];
            eri4_batch[36] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[0];
            eri4_batch[36] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[36];
            eri4_batch[37] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[10];
            eri4_batch[37] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[1];
            eri4_batch[37] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[37];
            eri4_batch[38] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[11];
            eri4_batch[38] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[2];
            eri4_batch[38] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[38];
            eri4_batch[39] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[12];
            eri4_batch[39] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[3];
            eri4_batch[39] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[39];
            eri4_batch[40] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[13];
            eri4_batch[40] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[4];
            eri4_batch[40] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[40];
            eri4_batch[41] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[14];
            eri4_batch[41] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[5];
            eri4_batch[41] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[41];
            eri4_batch[42] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[15];
            eri4_batch[42] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[6];
            eri4_batch[42] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[42];
            eri4_batch[43] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[16];
            eri4_batch[43] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[7];
            eri4_batch[43] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[43];
            eri4_batch[44] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[17];
            eri4_batch[44] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[8];
            eri4_batch[44] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[44];
            eri4_batch[45] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[9];
            eri4_batch[45] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[0];
            eri4_batch[45] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[45];
            eri4_batch[45] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[18];
            eri4_batch[46] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[10];
            eri4_batch[46] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[1];
            eri4_batch[46] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[46];
            eri4_batch[46] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[19];
            eri4_batch[47] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[11];
            eri4_batch[47] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[2];
            eri4_batch[47] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[47];
            eri4_batch[47] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[20];
            eri4_batch[48] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[12];
            eri4_batch[48] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[3];
            eri4_batch[48] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[48];
            eri4_batch[48] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[21];
            eri4_batch[49] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[13];
            eri4_batch[49] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[4];
            eri4_batch[49] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[49];
            eri4_batch[49] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[22];
            eri4_batch[50] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[14];
            eri4_batch[50] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[5];
            eri4_batch[50] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[50];
            eri4_batch[50] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[23];
            eri4_batch[51] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[15];
            eri4_batch[51] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[6];
            eri4_batch[51] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[51];
            eri4_batch[51] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[24];
            eri4_batch[52] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[16];
            eri4_batch[52] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[7];
            eri4_batch[52] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[52];
            eri4_batch[52] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[25];
            eri4_batch[53] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[17];
            eri4_batch[53] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[8];
            eri4_batch[53] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[53];
            eri4_batch[53] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[26];
            eri4_batch[54] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[0];
            eri4_batch[54] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[27];
            eri4_batch[54] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[18];
            eri4_batch[54] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[72];
            eri4_batch[55] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[1];
            eri4_batch[55] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[28];
            eri4_batch[55] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[19];
            eri4_batch[55] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[73];
            eri4_batch[56] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[2];
            eri4_batch[56] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[29];
            eri4_batch[56] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[20];
            eri4_batch[56] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[74];
            eri4_batch[57] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[3];
            eri4_batch[57] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[30];
            eri4_batch[57] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[21];
            eri4_batch[57] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[75];
            eri4_batch[58] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[4];
            eri4_batch[58] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[31];
            eri4_batch[58] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[22];
            eri4_batch[58] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[76];
            eri4_batch[59] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[5];
            eri4_batch[59] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[32];
            eri4_batch[59] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[23];
            eri4_batch[59] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[77];
            eri4_batch[60] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[6];
            eri4_batch[60] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[33];
            eri4_batch[60] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[24];
            eri4_batch[60] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[78];
            eri4_batch[61] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[7];
            eri4_batch[61] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[34];
            eri4_batch[61] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[25];
            eri4_batch[61] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[79];
            eri4_batch[62] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[8];
            eri4_batch[62] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[35];
            eri4_batch[62] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[26];
            eri4_batch[62] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[80];
            eri4_batch[63] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[9];
            eri4_batch[63] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[0];
            eri4_batch[63] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[45];
            eri4_batch[63] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[18];
            eri4_batch[64] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[10];
            eri4_batch[64] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[1];
            eri4_batch[64] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[46];
            eri4_batch[64] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[19];
            eri4_batch[65] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[11];
            eri4_batch[65] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[2];
            eri4_batch[65] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[47];
            eri4_batch[65] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[20];
            eri4_batch[66] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[12];
            eri4_batch[66] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[3];
            eri4_batch[66] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[48];
            eri4_batch[66] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[21];
            eri4_batch[67] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[13];
            eri4_batch[67] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[4];
            eri4_batch[67] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[49];
            eri4_batch[67] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[22];
            eri4_batch[68] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[14];
            eri4_batch[68] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[5];
            eri4_batch[68] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[50];
            eri4_batch[68] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[23];
            eri4_batch[69] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[15];
            eri4_batch[69] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[6];
            eri4_batch[69] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[51];
            eri4_batch[69] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[24];
            eri4_batch[70] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[16];
            eri4_batch[70] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[7];
            eri4_batch[70] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[52];
            eri4_batch[70] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[25];
            eri4_batch[71] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[17];
            eri4_batch[71] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[8];
            eri4_batch[71] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[53];
            eri4_batch[71] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[26];
            eri4_batch[72] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[63];
            eri4_batch[72] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[0];
            eri4_batch[72] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[18];
            eri4_batch[73] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[64];
            eri4_batch[73] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[1];
            eri4_batch[73] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[19];
            eri4_batch[74] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[65];
            eri4_batch[74] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[2];
            eri4_batch[74] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[20];
            eri4_batch[75] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[66];
            eri4_batch[75] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[3];
            eri4_batch[75] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[21];
            eri4_batch[76] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[67];
            eri4_batch[76] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[4];
            eri4_batch[76] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[22];
            eri4_batch[77] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[68];
            eri4_batch[77] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[5];
            eri4_batch[77] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[23];
            eri4_batch[78] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[69];
            eri4_batch[78] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[6];
            eri4_batch[78] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[24];
            eri4_batch[79] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[70];
            eri4_batch[79] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[7];
            eri4_batch[79] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[25];
            eri4_batch[80] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[71];
            eri4_batch[80] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[8];
            eri4_batch[80] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[26];
        }
}

template<> void lible::ints::two::eri4Kernel<1, 1, 2, 0>(const int cdepth_a, const int cdepth_b,
                                                         const int cdepth_c, const int cdepth_d,
                                                         const double *exps_a, const double *exps_b,
                                                         const double *exps_c, const double *exps_d,
                                                         const double *coords_a, const double *coords_b,
                                                         const double *coords_c, const double *coords_d,
                                                         const double *ecoeffs_ab, const double *ecoeffs_cd_tsp,
                                                         double *eri4_batch)
{
    constexpr int la = 1, lb = 1, lc = 2, ld = 0;
    constexpr int lab = la + lb;
    constexpr int lcd = lc + ld;
    constexpr int labcd = lab + lcd;

    constexpr int n_sph_a = numSphericalsC(la);
    constexpr int n_sph_b = numSphericalsC(lb);
    constexpr int n_sph_c = numSphericalsC(lc);
    constexpr int n_sph_d = numSphericalsC(ld);
    constexpr int n_hermite_ab = numHermitesC(lab);
    constexpr int n_hermite_cd = numHermitesC(lcd);
    constexpr int n_sph_ab = n_sph_a * n_sph_b;
    constexpr int n_sph_cd = n_sph_c * n_sph_d;
    constexpr int n_ecoeffs_ab = n_sph_ab * n_hermite_ab;

    constexpr int n_ecoeffs_cd = n_sph_cd * n_hermite_cd;

    std::fill(eri4_batch, eri4_batch + n_sph_ab * n_sph_cd, 0);

    std::array<double, labcd + 1> fnx;
    BoysF2<labcd> boys_f;

    constexpr int n_hermites_abcd = numHermitesC(lab) * numHermitesC(lcd);
    std::array<double, n_hermites_abcd> rints;

    constexpr int n_rints_x_ecoeffs = n_sph_cd * n_hermite_ab;
    std::vector<double> rints_x_ecoeffs(cdepth_a * cdepth_b * n_rints_x_ecoeffs, 0);

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            int pos_rints_x_ecoeffs = iab * n_rints_x_ecoeffs;
            for (int ic = 0, icd = 0; ic < cdepth_c; ic++)
                for (int id = 0; id < cdepth_d; id++, icd++)
                {
                    double a = exps_a[ia];
                    double b = exps_b[ib];
                    double c = exps_c[ic];
                    double d = exps_d[id];
                    double p = a + b;
                    double q = c + d;
                    std::array<double, 3> xyz_p{(a * coords_a[0] + b * coords_b[0]) / p,
                                                (a * coords_a[1] + b * coords_b[1]) / p,
                                                (a * coords_a[2] + b * coords_b[2]) / p};

                    std::array<double, 3> xyz_q{(c * coords_c[0] + d * coords_d[0]) / q,
                                                (c * coords_c[1] + d * coords_d[1]) / q,
                                                (c * coords_c[2] + d * coords_d[2]) / q};

                    std::array<double, 3> xyz_pq{xyz_p[0] - xyz_q[0], xyz_p[1] - xyz_q[1],
                                                 xyz_p[2] - xyz_q[2]};

                    double alpha = p * q / (p + q);
                    double dx{xyz_pq[0]}, dy{xyz_pq[1]}, dz{xyz_pq[2]};
                    double x = alpha * (dx * dx + dy * dy + dz * dz);
                    boys_f.calcFnx(x, &fnx[0]);

                    double fac = (2.0 * std::pow(M_PI, 2.5) / (p * q * std::sqrt(p + q)));
                    calcRInts<lab, lcd>(alpha, fac, &fnx[0], &xyz_pq[0], &rints[0]);

                    const double* p_ecoeffs_cd_tsp = &ecoeffs_cd_tsp[icd * n_ecoeffs_cd];
                    double* p_rints_x_ecoeffs = &rints_x_ecoeffs[pos_rints_x_ecoeffs];

                    p_rints_x_ecoeffs[0] += rints[2] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[0] += rints[7] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[0] += rints[0] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[0] += rints[1] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[0] += rints[9] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[0] += rints[4] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[0] += rints[3] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[1] += rints[1] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[1] += rints[0] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[1] += rints[3] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[1] += rints[6] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[2] += rints[0] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[2] += rints[3] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[2] += rints[2] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[2] += rints[8] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[3] += rints[2] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[3] += rints[7] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[3] += rints[0] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[3] += rints[1] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[3] += rints[4] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[4] += rints[1] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[4] += rints[0] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[4] += rints[5] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[4] += rints[2] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[5] += rints[12] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[5] += rints[17] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[5] += rints[10] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[5] += rints[11] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[5] += rints[19] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[5] += rints[14] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[5] += rints[13] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[6] += rints[11] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[6] += rints[10] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[6] += rints[13] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[6] += rints[16] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[7] += rints[10] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[7] += rints[13] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[7] += rints[12] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[7] += rints[18] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[8] += rints[12] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[8] += rints[17] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[8] += rints[10] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[8] += rints[11] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[8] += rints[14] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[9] += rints[11] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[9] += rints[10] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[9] += rints[15] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[9] += rints[12] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[10] += rints[22] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[10] += rints[27] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[10] += rints[20] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[10] += rints[21] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[10] += rints[29] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[10] += rints[24] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[10] += rints[23] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[11] += rints[21] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[11] += rints[20] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[11] += rints[23] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[11] += rints[26] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[12] += rints[20] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[12] += rints[23] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[12] += rints[22] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[12] += rints[28] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[13] += rints[22] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[13] += rints[27] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[13] += rints[20] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[13] += rints[21] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[13] += rints[24] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[14] += rints[21] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[14] += rints[20] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[14] += rints[25] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[14] += rints[22] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[15] += rints[32] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[15] += rints[37] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[15] += rints[30] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[15] += rints[31] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[15] += rints[39] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[15] += rints[34] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[15] += rints[33] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[16] += rints[31] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[16] += rints[30] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[16] += rints[33] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[16] += rints[36] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[17] += rints[30] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[17] += rints[33] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[17] += rints[32] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[17] += rints[38] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[18] += rints[32] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[18] += rints[37] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[18] += rints[30] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[18] += rints[31] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[18] += rints[34] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[19] += rints[31] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[19] += rints[30] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[19] += rints[35] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[19] += rints[32] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[20] += rints[42] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[20] += rints[47] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[20] += rints[40] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[20] += rints[41] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[20] += rints[49] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[20] += rints[44] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[20] += rints[43] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[21] += rints[41] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[21] += rints[40] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[21] += rints[43] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[21] += rints[46] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[22] += rints[40] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[22] += rints[43] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[22] += rints[42] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[22] += rints[48] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[23] += rints[42] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[23] += rints[47] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[23] += rints[40] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[23] += rints[41] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[23] += rints[44] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[24] += rints[41] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[24] += rints[40] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[24] += rints[45] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[24] += rints[42] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[25] += rints[52] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[25] += rints[57] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[25] += rints[50] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[25] += rints[51] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[25] += rints[59] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[25] += rints[54] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[25] += rints[53] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[26] += rints[51] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[26] += rints[50] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[26] += rints[53] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[26] += rints[56] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[27] += rints[50] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[27] += rints[53] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[27] += rints[52] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[27] += rints[58] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[28] += rints[52] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[28] += rints[57] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[28] += rints[50] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[28] += rints[51] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[28] += rints[54] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[29] += rints[51] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[29] += rints[50] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[29] += rints[55] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[29] += rints[52] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[30] += rints[62] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[30] += rints[67] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[30] += rints[60] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[30] += rints[61] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[30] += rints[69] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[30] += rints[64] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[30] += rints[63] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[31] += rints[61] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[31] += rints[60] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[31] += rints[63] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[31] += rints[66] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[32] += rints[60] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[32] += rints[63] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[32] += rints[62] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[32] += rints[68] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[33] += rints[62] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[33] += rints[67] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[33] += rints[60] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[33] += rints[61] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[33] += rints[64] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[34] += rints[61] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[34] += rints[60] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[34] += rints[65] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[34] += rints[62] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[35] += rints[72] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[35] += rints[77] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[35] += rints[70] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[35] += rints[71] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[35] += rints[79] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[35] += rints[74] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[35] += rints[73] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[36] += rints[71] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[36] += rints[70] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[36] += rints[73] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[36] += rints[76] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[37] += rints[70] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[37] += rints[73] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[37] += rints[72] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[37] += rints[78] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[38] += rints[72] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[38] += rints[77] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[38] += rints[70] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[38] += rints[71] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[38] += rints[74] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[39] += rints[71] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[39] += rints[70] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[39] += rints[75] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[39] += rints[72] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[40] += rints[82] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[40] += rints[87] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[40] += rints[80] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[40] += rints[81] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[40] += rints[89] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[40] += rints[84] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[40] += rints[83] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[41] += rints[81] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[41] += rints[80] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[41] += rints[83] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[41] += rints[86] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[42] += rints[80] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[42] += rints[83] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[42] += rints[82] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[42] += rints[88] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[43] += rints[82] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[43] += rints[87] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[43] += rints[80] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[43] += rints[81] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[43] += rints[84] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[44] += rints[81] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[44] += rints[80] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[44] += rints[85] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[44] += rints[82] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[45] += rints[92] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[45] += rints[97] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[45] += rints[90] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[45] += rints[91] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[45] += rints[99] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[45] += rints[94] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[45] += rints[93] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[46] += rints[91] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[46] += rints[90] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[46] += rints[93] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[46] += rints[96] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[47] += rints[90] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[47] += rints[93] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[47] += rints[92] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[47] += rints[98] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[48] += rints[92] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[48] += rints[97] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[48] += rints[90] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[48] += rints[91] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[48] += rints[94] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[49] += rints[91] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[49] += rints[90] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[49] += rints[95] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[49] += rints[92] * p_ecoeffs_cd_tsp[14];
                }
        }

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            const double* p_ecoeffs_ab = &ecoeffs_ab[iab * n_ecoeffs_ab];
            const double* p_rints_x_ecoeffs = &rints_x_ecoeffs[iab * n_rints_x_ecoeffs];

            eri4_batch[0] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[0];
            eri4_batch[0] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[15];
            eri4_batch[0] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[45];
            eri4_batch[1] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[1];
            eri4_batch[1] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[16];
            eri4_batch[1] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[46];
            eri4_batch[2] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[2];
            eri4_batch[2] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[17];
            eri4_batch[2] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[47];
            eri4_batch[3] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[3];
            eri4_batch[3] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[18];
            eri4_batch[3] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[48];
            eri4_batch[4] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[4];
            eri4_batch[4] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[19];
            eri4_batch[4] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[49];
            eri4_batch[5] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[5];
            eri4_batch[5] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[0];
            eri4_batch[5] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[15];
            eri4_batch[5] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[30];
            eri4_batch[6] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[6];
            eri4_batch[6] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[1];
            eri4_batch[6] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[16];
            eri4_batch[6] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[31];
            eri4_batch[7] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[7];
            eri4_batch[7] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[2];
            eri4_batch[7] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[17];
            eri4_batch[7] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[32];
            eri4_batch[8] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[8];
            eri4_batch[8] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[3];
            eri4_batch[8] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[18];
            eri4_batch[8] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[33];
            eri4_batch[9] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[9];
            eri4_batch[9] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[4];
            eri4_batch[9] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[19];
            eri4_batch[9] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[34];
            eri4_batch[10] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[0];
            eri4_batch[10] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[15];
            eri4_batch[10] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[10];
            eri4_batch[10] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[40];
            eri4_batch[11] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[1];
            eri4_batch[11] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[16];
            eri4_batch[11] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[11];
            eri4_batch[11] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[41];
            eri4_batch[12] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[2];
            eri4_batch[12] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[17];
            eri4_batch[12] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[12];
            eri4_batch[12] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[42];
            eri4_batch[13] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[3];
            eri4_batch[13] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[18];
            eri4_batch[13] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[13];
            eri4_batch[13] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[43];
            eri4_batch[14] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[4];
            eri4_batch[14] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[19];
            eri4_batch[14] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[14];
            eri4_batch[14] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[44];
            eri4_batch[15] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[5];
            eri4_batch[15] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[0];
            eri4_batch[15] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[15];
            eri4_batch[15] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[30];
            eri4_batch[16] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[6];
            eri4_batch[16] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[1];
            eri4_batch[16] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[16];
            eri4_batch[16] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[31];
            eri4_batch[17] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[7];
            eri4_batch[17] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[2];
            eri4_batch[17] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[17];
            eri4_batch[17] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[32];
            eri4_batch[18] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[8];
            eri4_batch[18] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[3];
            eri4_batch[18] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[18];
            eri4_batch[18] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[33];
            eri4_batch[19] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[9];
            eri4_batch[19] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[4];
            eri4_batch[19] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[19];
            eri4_batch[19] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[34];
            eri4_batch[20] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[5];
            eri4_batch[20] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[0];
            eri4_batch[20] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[20];
            eri4_batch[21] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[6];
            eri4_batch[21] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[1];
            eri4_batch[21] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[21];
            eri4_batch[22] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[7];
            eri4_batch[22] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[2];
            eri4_batch[22] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[22];
            eri4_batch[23] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[8];
            eri4_batch[23] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[3];
            eri4_batch[23] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[23];
            eri4_batch[24] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[9];
            eri4_batch[24] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[4];
            eri4_batch[24] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[24];
            eri4_batch[25] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[5];
            eri4_batch[25] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[0];
            eri4_batch[25] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[25];
            eri4_batch[25] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[10];
            eri4_batch[26] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[6];
            eri4_batch[26] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[1];
            eri4_batch[26] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[26];
            eri4_batch[26] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[11];
            eri4_batch[27] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[7];
            eri4_batch[27] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[2];
            eri4_batch[27] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[27];
            eri4_batch[27] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[12];
            eri4_batch[28] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[8];
            eri4_batch[28] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[3];
            eri4_batch[28] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[28];
            eri4_batch[28] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[13];
            eri4_batch[29] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[9];
            eri4_batch[29] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[4];
            eri4_batch[29] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[29];
            eri4_batch[29] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[14];
            eri4_batch[30] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[0];
            eri4_batch[30] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[15];
            eri4_batch[30] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[10];
            eri4_batch[30] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[40];
            eri4_batch[31] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[1];
            eri4_batch[31] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[16];
            eri4_batch[31] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[11];
            eri4_batch[31] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[41];
            eri4_batch[32] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[2];
            eri4_batch[32] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[17];
            eri4_batch[32] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[12];
            eri4_batch[32] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[42];
            eri4_batch[33] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[3];
            eri4_batch[33] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[18];
            eri4_batch[33] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[13];
            eri4_batch[33] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[43];
            eri4_batch[34] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[4];
            eri4_batch[34] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[19];
            eri4_batch[34] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[14];
            eri4_batch[34] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[44];
            eri4_batch[35] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[5];
            eri4_batch[35] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[0];
            eri4_batch[35] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[25];
            eri4_batch[35] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[10];
            eri4_batch[36] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[6];
            eri4_batch[36] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[1];
            eri4_batch[36] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[26];
            eri4_batch[36] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[11];
            eri4_batch[37] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[7];
            eri4_batch[37] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[2];
            eri4_batch[37] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[27];
            eri4_batch[37] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[12];
            eri4_batch[38] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[8];
            eri4_batch[38] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[3];
            eri4_batch[38] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[28];
            eri4_batch[38] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[13];
            eri4_batch[39] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[9];
            eri4_batch[39] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[4];
            eri4_batch[39] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[29];
            eri4_batch[39] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[14];
            eri4_batch[40] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[35];
            eri4_batch[40] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[0];
            eri4_batch[40] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[10];
            eri4_batch[41] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[36];
            eri4_batch[41] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[1];
            eri4_batch[41] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[11];
            eri4_batch[42] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[37];
            eri4_batch[42] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[2];
            eri4_batch[42] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[12];
            eri4_batch[43] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[38];
            eri4_batch[43] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[3];
            eri4_batch[43] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[13];
            eri4_batch[44] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[39];
            eri4_batch[44] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[4];
            eri4_batch[44] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[14];
        }
}

template<> void lible::ints::two::eri4Kernel<2, 0, 1, 1>(const int cdepth_a, const int cdepth_b,
                                                         const int cdepth_c, const int cdepth_d,
                                                         const double *exps_a, const double *exps_b,
                                                         const double *exps_c, const double *exps_d,
                                                         const double *coords_a, const double *coords_b,
                                                         const double *coords_c, const double *coords_d,
                                                         const double *ecoeffs_ab, const double *ecoeffs_cd_tsp,
                                                         double *eri4_batch)
{
    constexpr int la = 2, lb = 0, lc = 1, ld = 1;
    constexpr int lab = la + lb;
    constexpr int lcd = lc + ld;
    constexpr int labcd = lab + lcd;

    constexpr int n_sph_a = numSphericalsC(la);
    constexpr int n_sph_b = numSphericalsC(lb);
    constexpr int n_sph_c = numSphericalsC(lc);
    constexpr int n_sph_d = numSphericalsC(ld);
    constexpr int n_hermite_ab = numHermitesC(lab);
    constexpr int n_hermite_cd = numHermitesC(lcd);
    constexpr int n_sph_ab = n_sph_a * n_sph_b;
    constexpr int n_sph_cd = n_sph_c * n_sph_d;
    constexpr int n_ecoeffs_ab = n_sph_ab * n_hermite_ab;

    constexpr int n_ecoeffs_cd = n_sph_cd * n_hermite_cd;

    std::fill(eri4_batch, eri4_batch + n_sph_ab * n_sph_cd, 0);

    std::array<double, labcd + 1> fnx;
    BoysF2<labcd> boys_f;

    constexpr int n_hermites_abcd = numHermitesC(lab) * numHermitesC(lcd);
    std::array<double, n_hermites_abcd> rints;

    constexpr int n_rints_x_ecoeffs = n_sph_cd * n_hermite_ab;
    std::vector<double> rints_x_ecoeffs(cdepth_a * cdepth_b * n_rints_x_ecoeffs, 0);

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            int pos_rints_x_ecoeffs = iab * n_rints_x_ecoeffs;
            for (int ic = 0, icd = 0; ic < cdepth_c; ic++)
                for (int id = 0; id < cdepth_d; id++, icd++)
                {
                    double a = exps_a[ia];
                    double b = exps_b[ib];
                    double c = exps_c[ic];
                    double d = exps_d[id];
                    double p = a + b;
                    double q = c + d;
                    std::array<double, 3> xyz_p{(a * coords_a[0] + b * coords_b[0]) / p,
                                                (a * coords_a[1] + b * coords_b[1]) / p,
                                                (a * coords_a[2] + b * coords_b[2]) / p};

                    std::array<double, 3> xyz_q{(c * coords_c[0] + d * coords_d[0]) / q,
                                                (c * coords_c[1] + d * coords_d[1]) / q,
                                                (c * coords_c[2] + d * coords_d[2]) / q};

                    std::array<double, 3> xyz_pq{xyz_p[0] - xyz_q[0], xyz_p[1] - xyz_q[1],
                                                 xyz_p[2] - xyz_q[2]};

                    double alpha = p * q / (p + q);
                    double dx{xyz_pq[0]}, dy{xyz_pq[1]}, dz{xyz_pq[2]};
                    double x = alpha * (dx * dx + dy * dy + dz * dz);
                    boys_f.calcFnx(x, &fnx[0]);

                    double fac = (2.0 * std::pow(M_PI, 2.5) / (p * q * std::sqrt(p + q)));
                    calcRInts<lab, lcd>(alpha, fac, &fnx[0], &xyz_pq[0], &rints[0]);

                    const double* p_ecoeffs_cd_tsp = &ecoeffs_cd_tsp[icd * n_ecoeffs_cd];
                    double* p_rints_x_ecoeffs = &rints_x_ecoeffs[pos_rints_x_ecoeffs];

                    p_rints_x_ecoeffs[0] += rints[0] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[0] += rints[3] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[0] += rints[9] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[1] += rints[1] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[1] += rints[0] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[1] += rints[3] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[1] += rints[6] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[2] += rints[0] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[2] += rints[3] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[2] += rints[2] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[2] += rints[8] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[3] += rints[1] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[3] += rints[0] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[3] += rints[3] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[3] += rints[6] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[4] += rints[1] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[4] += rints[0] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[4] += rints[4] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[5] += rints[1] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[5] += rints[0] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[5] += rints[5] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[5] += rints[2] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[6] += rints[0] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[6] += rints[3] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[6] += rints[2] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[6] += rints[8] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[7] += rints[1] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[7] += rints[0] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[7] += rints[5] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[7] += rints[2] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[8] += rints[7] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[8] += rints[0] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[8] += rints[2] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[9] += rints[10] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[9] += rints[13] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[9] += rints[19] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[10] += rints[11] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[10] += rints[10] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[10] += rints[13] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[10] += rints[16] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[11] += rints[10] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[11] += rints[13] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[11] += rints[12] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[11] += rints[18] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[12] += rints[11] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[12] += rints[10] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[12] += rints[13] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[12] += rints[16] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[13] += rints[11] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[13] += rints[10] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[13] += rints[14] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[14] += rints[11] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[14] += rints[10] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[14] += rints[15] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[14] += rints[12] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[15] += rints[10] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[15] += rints[13] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[15] += rints[12] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[15] += rints[18] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[16] += rints[11] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[16] += rints[10] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[16] += rints[15] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[16] += rints[12] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[17] += rints[17] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[17] += rints[10] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[17] += rints[12] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[18] += rints[20] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[18] += rints[23] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[18] += rints[29] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[19] += rints[21] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[19] += rints[20] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[19] += rints[23] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[19] += rints[26] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[20] += rints[20] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[20] += rints[23] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[20] += rints[22] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[20] += rints[28] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[21] += rints[21] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[21] += rints[20] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[21] += rints[23] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[21] += rints[26] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[22] += rints[21] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[22] += rints[20] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[22] += rints[24] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[23] += rints[21] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[23] += rints[20] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[23] += rints[25] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[23] += rints[22] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[24] += rints[20] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[24] += rints[23] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[24] += rints[22] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[24] += rints[28] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[25] += rints[21] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[25] += rints[20] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[25] += rints[25] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[25] += rints[22] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[26] += rints[27] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[26] += rints[20] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[26] += rints[22] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[27] += rints[30] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[27] += rints[33] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[27] += rints[39] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[28] += rints[31] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[28] += rints[30] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[28] += rints[33] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[28] += rints[36] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[29] += rints[30] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[29] += rints[33] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[29] += rints[32] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[29] += rints[38] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[30] += rints[31] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[30] += rints[30] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[30] += rints[33] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[30] += rints[36] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[31] += rints[31] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[31] += rints[30] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[31] += rints[34] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[32] += rints[31] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[32] += rints[30] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[32] += rints[35] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[32] += rints[32] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[33] += rints[30] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[33] += rints[33] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[33] += rints[32] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[33] += rints[38] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[34] += rints[31] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[34] += rints[30] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[34] += rints[35] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[34] += rints[32] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[35] += rints[37] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[35] += rints[30] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[35] += rints[32] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[36] += rints[40] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[36] += rints[43] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[36] += rints[49] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[37] += rints[41] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[37] += rints[40] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[37] += rints[43] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[37] += rints[46] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[38] += rints[40] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[38] += rints[43] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[38] += rints[42] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[38] += rints[48] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[39] += rints[41] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[39] += rints[40] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[39] += rints[43] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[39] += rints[46] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[40] += rints[41] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[40] += rints[40] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[40] += rints[44] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[41] += rints[41] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[41] += rints[40] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[41] += rints[45] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[41] += rints[42] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[42] += rints[40] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[42] += rints[43] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[42] += rints[42] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[42] += rints[48] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[43] += rints[41] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[43] += rints[40] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[43] += rints[45] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[43] += rints[42] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[44] += rints[47] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[44] += rints[40] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[44] += rints[42] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[45] += rints[50] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[45] += rints[53] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[45] += rints[59] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[46] += rints[51] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[46] += rints[50] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[46] += rints[53] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[46] += rints[56] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[47] += rints[50] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[47] += rints[53] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[47] += rints[52] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[47] += rints[58] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[48] += rints[51] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[48] += rints[50] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[48] += rints[53] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[48] += rints[56] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[49] += rints[51] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[49] += rints[50] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[49] += rints[54] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[50] += rints[51] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[50] += rints[50] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[50] += rints[55] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[50] += rints[52] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[51] += rints[50] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[51] += rints[53] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[51] += rints[52] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[51] += rints[58] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[52] += rints[51] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[52] += rints[50] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[52] += rints[55] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[52] += rints[52] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[53] += rints[57] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[53] += rints[50] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[53] += rints[52] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[54] += rints[60] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[54] += rints[63] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[54] += rints[69] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[55] += rints[61] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[55] += rints[60] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[55] += rints[63] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[55] += rints[66] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[56] += rints[60] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[56] += rints[63] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[56] += rints[62] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[56] += rints[68] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[57] += rints[61] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[57] += rints[60] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[57] += rints[63] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[57] += rints[66] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[58] += rints[61] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[58] += rints[60] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[58] += rints[64] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[59] += rints[61] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[59] += rints[60] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[59] += rints[65] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[59] += rints[62] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[60] += rints[60] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[60] += rints[63] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[60] += rints[62] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[60] += rints[68] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[61] += rints[61] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[61] += rints[60] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[61] += rints[65] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[61] += rints[62] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[62] += rints[67] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[62] += rints[60] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[62] += rints[62] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[63] += rints[70] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[63] += rints[73] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[63] += rints[79] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[64] += rints[71] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[64] += rints[70] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[64] += rints[73] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[64] += rints[76] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[65] += rints[70] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[65] += rints[73] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[65] += rints[72] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[65] += rints[78] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[66] += rints[71] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[66] += rints[70] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[66] += rints[73] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[66] += rints[76] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[67] += rints[71] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[67] += rints[70] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[67] += rints[74] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[68] += rints[71] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[68] += rints[70] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[68] += rints[75] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[68] += rints[72] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[69] += rints[70] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[69] += rints[73] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[69] += rints[72] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[69] += rints[78] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[70] += rints[71] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[70] += rints[70] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[70] += rints[75] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[70] += rints[72] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[71] += rints[77] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[71] += rints[70] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[71] += rints[72] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[72] += rints[80] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[72] += rints[83] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[72] += rints[89] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[73] += rints[81] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[73] += rints[80] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[73] += rints[83] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[73] += rints[86] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[74] += rints[80] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[74] += rints[83] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[74] += rints[82] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[74] += rints[88] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[75] += rints[81] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[75] += rints[80] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[75] += rints[83] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[75] += rints[86] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[76] += rints[81] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[76] += rints[80] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[76] += rints[84] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[77] += rints[81] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[77] += rints[80] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[77] += rints[85] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[77] += rints[82] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[78] += rints[80] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[78] += rints[83] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[78] += rints[82] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[78] += rints[88] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[79] += rints[81] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[79] += rints[80] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[79] += rints[85] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[79] += rints[82] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[80] += rints[87] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[80] += rints[80] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[80] += rints[82] * p_ecoeffs_cd_tsp[26];
                    p_rints_x_ecoeffs[81] += rints[90] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[81] += rints[93] * p_ecoeffs_cd_tsp[27];
                    p_rints_x_ecoeffs[81] += rints[99] * p_ecoeffs_cd_tsp[81];
                    p_rints_x_ecoeffs[82] += rints[91] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[82] += rints[90] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[82] += rints[93] * p_ecoeffs_cd_tsp[28];
                    p_rints_x_ecoeffs[82] += rints[96] * p_ecoeffs_cd_tsp[55];
                    p_rints_x_ecoeffs[83] += rints[90] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[83] += rints[93] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[83] += rints[92] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[83] += rints[98] * p_ecoeffs_cd_tsp[74];
                    p_rints_x_ecoeffs[84] += rints[91] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[84] += rints[90] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[84] += rints[93] * p_ecoeffs_cd_tsp[30];
                    p_rints_x_ecoeffs[84] += rints[96] * p_ecoeffs_cd_tsp[57];
                    p_rints_x_ecoeffs[85] += rints[91] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[85] += rints[90] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[85] += rints[94] * p_ecoeffs_cd_tsp[40];
                    p_rints_x_ecoeffs[86] += rints[91] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[86] += rints[90] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[86] += rints[95] * p_ecoeffs_cd_tsp[50];
                    p_rints_x_ecoeffs[86] += rints[92] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[87] += rints[90] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[87] += rints[93] * p_ecoeffs_cd_tsp[33];
                    p_rints_x_ecoeffs[87] += rints[92] * p_ecoeffs_cd_tsp[24];
                    p_rints_x_ecoeffs[87] += rints[98] * p_ecoeffs_cd_tsp[78];
                    p_rints_x_ecoeffs[88] += rints[91] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[88] += rints[90] * p_ecoeffs_cd_tsp[7];
                    p_rints_x_ecoeffs[88] += rints[95] * p_ecoeffs_cd_tsp[52];
                    p_rints_x_ecoeffs[88] += rints[92] * p_ecoeffs_cd_tsp[25];
                    p_rints_x_ecoeffs[89] += rints[97] * p_ecoeffs_cd_tsp[71];
                    p_rints_x_ecoeffs[89] += rints[90] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[89] += rints[92] * p_ecoeffs_cd_tsp[26];
                }
        }

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            const double* p_ecoeffs_ab = &ecoeffs_ab[iab * n_ecoeffs_ab];
            const double* p_rints_x_ecoeffs = &rints_x_ecoeffs[iab * n_rints_x_ecoeffs];

            eri4_batch[0] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[18];
            eri4_batch[0] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[63];
            eri4_batch[0] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[0];
            eri4_batch[0] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[9];
            eri4_batch[0] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[81];
            eri4_batch[0] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[36];
            eri4_batch[0] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[27];
            eri4_batch[1] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[19];
            eri4_batch[1] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[64];
            eri4_batch[1] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[1];
            eri4_batch[1] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[10];
            eri4_batch[1] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[82];
            eri4_batch[1] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[37];
            eri4_batch[1] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[28];
            eri4_batch[2] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[20];
            eri4_batch[2] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[65];
            eri4_batch[2] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[2];
            eri4_batch[2] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[11];
            eri4_batch[2] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[83];
            eri4_batch[2] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[38];
            eri4_batch[2] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[29];
            eri4_batch[3] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[21];
            eri4_batch[3] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[66];
            eri4_batch[3] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[3];
            eri4_batch[3] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[12];
            eri4_batch[3] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[84];
            eri4_batch[3] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[39];
            eri4_batch[3] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[30];
            eri4_batch[4] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[22];
            eri4_batch[4] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[67];
            eri4_batch[4] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[4];
            eri4_batch[4] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[13];
            eri4_batch[4] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[85];
            eri4_batch[4] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[40];
            eri4_batch[4] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[31];
            eri4_batch[5] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[23];
            eri4_batch[5] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[68];
            eri4_batch[5] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[5];
            eri4_batch[5] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[14];
            eri4_batch[5] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[86];
            eri4_batch[5] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[41];
            eri4_batch[5] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[32];
            eri4_batch[6] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[24];
            eri4_batch[6] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[69];
            eri4_batch[6] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[6];
            eri4_batch[6] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[15];
            eri4_batch[6] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[87];
            eri4_batch[6] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[42];
            eri4_batch[6] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[33];
            eri4_batch[7] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[25];
            eri4_batch[7] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[70];
            eri4_batch[7] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[7];
            eri4_batch[7] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[16];
            eri4_batch[7] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[88];
            eri4_batch[7] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[43];
            eri4_batch[7] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[34];
            eri4_batch[8] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[26];
            eri4_batch[8] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[71];
            eri4_batch[8] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[8];
            eri4_batch[8] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[17];
            eri4_batch[8] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[89];
            eri4_batch[8] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[44];
            eri4_batch[8] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[35];
            eri4_batch[9] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[9];
            eri4_batch[9] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[0];
            eri4_batch[9] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[27];
            eri4_batch[9] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[54];
            eri4_batch[10] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[10];
            eri4_batch[10] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[1];
            eri4_batch[10] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[28];
            eri4_batch[10] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[55];
            eri4_batch[11] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[11];
            eri4_batch[11] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[2];
            eri4_batch[11] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[29];
            eri4_batch[11] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[56];
            eri4_batch[12] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[12];
            eri4_batch[12] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[3];
            eri4_batch[12] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[30];
            eri4_batch[12] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[57];
            eri4_batch[13] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[13];
            eri4_batch[13] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[4];
            eri4_batch[13] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[31];
            eri4_batch[13] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[58];
            eri4_batch[14] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[14];
            eri4_batch[14] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[5];
            eri4_batch[14] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[32];
            eri4_batch[14] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[59];
            eri4_batch[15] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[15];
            eri4_batch[15] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[6];
            eri4_batch[15] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[33];
            eri4_batch[15] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[60];
            eri4_batch[16] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[16];
            eri4_batch[16] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[7];
            eri4_batch[16] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[34];
            eri4_batch[16] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[61];
            eri4_batch[17] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[17];
            eri4_batch[17] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[8];
            eri4_batch[17] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[35];
            eri4_batch[17] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[62];
            eri4_batch[18] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[0];
            eri4_batch[18] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[27];
            eri4_batch[18] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[18];
            eri4_batch[18] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[72];
            eri4_batch[19] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[1];
            eri4_batch[19] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[28];
            eri4_batch[19] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[19];
            eri4_batch[19] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[73];
            eri4_batch[20] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[2];
            eri4_batch[20] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[29];
            eri4_batch[20] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[20];
            eri4_batch[20] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[74];
            eri4_batch[21] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[3];
            eri4_batch[21] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[30];
            eri4_batch[21] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[21];
            eri4_batch[21] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[75];
            eri4_batch[22] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[4];
            eri4_batch[22] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[31];
            eri4_batch[22] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[22];
            eri4_batch[22] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[76];
            eri4_batch[23] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[5];
            eri4_batch[23] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[32];
            eri4_batch[23] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[23];
            eri4_batch[23] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[77];
            eri4_batch[24] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[6];
            eri4_batch[24] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[33];
            eri4_batch[24] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[24];
            eri4_batch[24] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[78];
            eri4_batch[25] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[7];
            eri4_batch[25] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[34];
            eri4_batch[25] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[25];
            eri4_batch[25] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[79];
            eri4_batch[26] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[8];
            eri4_batch[26] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[35];
            eri4_batch[26] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[26];
            eri4_batch[26] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[80];
            eri4_batch[27] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[18];
            eri4_batch[27] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[63];
            eri4_batch[27] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[0];
            eri4_batch[27] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[9];
            eri4_batch[27] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[36];
            eri4_batch[28] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[19];
            eri4_batch[28] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[64];
            eri4_batch[28] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[1];
            eri4_batch[28] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[10];
            eri4_batch[28] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[37];
            eri4_batch[29] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[20];
            eri4_batch[29] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[65];
            eri4_batch[29] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[2];
            eri4_batch[29] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[11];
            eri4_batch[29] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[38];
            eri4_batch[30] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[21];
            eri4_batch[30] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[66];
            eri4_batch[30] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[3];
            eri4_batch[30] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[12];
            eri4_batch[30] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[39];
            eri4_batch[31] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[22];
            eri4_batch[31] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[67];
            eri4_batch[31] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[4];
            eri4_batch[31] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[13];
            eri4_batch[31] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[40];
            eri4_batch[32] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[23];
            eri4_batch[32] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[68];
            eri4_batch[32] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[5];
            eri4_batch[32] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[14];
            eri4_batch[32] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[41];
            eri4_batch[33] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[24];
            eri4_batch[33] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[69];
            eri4_batch[33] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[6];
            eri4_batch[33] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[15];
            eri4_batch[33] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[42];
            eri4_batch[34] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[25];
            eri4_batch[34] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[70];
            eri4_batch[34] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[7];
            eri4_batch[34] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[16];
            eri4_batch[34] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[43];
            eri4_batch[35] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[26];
            eri4_batch[35] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[71];
            eri4_batch[35] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[8];
            eri4_batch[35] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[17];
            eri4_batch[35] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[44];
            eri4_batch[36] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[9];
            eri4_batch[36] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[0];
            eri4_batch[36] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[45];
            eri4_batch[36] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[18];
            eri4_batch[37] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[10];
            eri4_batch[37] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[1];
            eri4_batch[37] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[46];
            eri4_batch[37] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[19];
            eri4_batch[38] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[11];
            eri4_batch[38] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[2];
            eri4_batch[38] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[47];
            eri4_batch[38] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[20];
            eri4_batch[39] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[12];
            eri4_batch[39] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[3];
            eri4_batch[39] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[48];
            eri4_batch[39] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[21];
            eri4_batch[40] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[13];
            eri4_batch[40] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[4];
            eri4_batch[40] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[49];
            eri4_batch[40] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[22];
            eri4_batch[41] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[14];
            eri4_batch[41] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[5];
            eri4_batch[41] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[50];
            eri4_batch[41] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[23];
            eri4_batch[42] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[15];
            eri4_batch[42] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[6];
            eri4_batch[42] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[51];
            eri4_batch[42] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[24];
            eri4_batch[43] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[16];
            eri4_batch[43] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[7];
            eri4_batch[43] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[52];
            eri4_batch[43] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[25];
            eri4_batch[44] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[17];
            eri4_batch[44] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[8];
            eri4_batch[44] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[53];
            eri4_batch[44] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[26];
        }
}

template<> void lible::ints::two::eri4Kernel<2, 0, 2, 0>(const int cdepth_a, const int cdepth_b,
                                                         const int cdepth_c, const int cdepth_d,
                                                         const double *exps_a, const double *exps_b,
                                                         const double *exps_c, const double *exps_d,
                                                         const double *coords_a, const double *coords_b,
                                                         const double *coords_c, const double *coords_d,
                                                         const double *ecoeffs_ab, const double *ecoeffs_cd_tsp,
                                                         double *eri4_batch)
{
    constexpr int la = 2, lb = 0, lc = 2, ld = 0;
    constexpr int lab = la + lb;
    constexpr int lcd = lc + ld;
    constexpr int labcd = lab + lcd;

    constexpr int n_sph_a = numSphericalsC(la);
    constexpr int n_sph_b = numSphericalsC(lb);
    constexpr int n_sph_c = numSphericalsC(lc);
    constexpr int n_sph_d = numSphericalsC(ld);
    constexpr int n_hermite_ab = numHermitesC(lab);
    constexpr int n_hermite_cd = numHermitesC(lcd);
    constexpr int n_sph_ab = n_sph_a * n_sph_b;
    constexpr int n_sph_cd = n_sph_c * n_sph_d;
    constexpr int n_ecoeffs_ab = n_sph_ab * n_hermite_ab;

    constexpr int n_ecoeffs_cd = n_sph_cd * n_hermite_cd;

    std::fill(eri4_batch, eri4_batch + n_sph_ab * n_sph_cd, 0);

    std::array<double, labcd + 1> fnx;
    BoysF2<labcd> boys_f;

    constexpr int n_hermites_abcd = numHermitesC(lab) * numHermitesC(lcd);
    std::array<double, n_hermites_abcd> rints;

    constexpr int n_rints_x_ecoeffs = n_sph_cd * n_hermite_ab;
    std::vector<double> rints_x_ecoeffs(cdepth_a * cdepth_b * n_rints_x_ecoeffs, 0);

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            int pos_rints_x_ecoeffs = iab * n_rints_x_ecoeffs;
            for (int ic = 0, icd = 0; ic < cdepth_c; ic++)
                for (int id = 0; id < cdepth_d; id++, icd++)
                {
                    double a = exps_a[ia];
                    double b = exps_b[ib];
                    double c = exps_c[ic];
                    double d = exps_d[id];
                    double p = a + b;
                    double q = c + d;
                    std::array<double, 3> xyz_p{(a * coords_a[0] + b * coords_b[0]) / p,
                                                (a * coords_a[1] + b * coords_b[1]) / p,
                                                (a * coords_a[2] + b * coords_b[2]) / p};

                    std::array<double, 3> xyz_q{(c * coords_c[0] + d * coords_d[0]) / q,
                                                (c * coords_c[1] + d * coords_d[1]) / q,
                                                (c * coords_c[2] + d * coords_d[2]) / q};

                    std::array<double, 3> xyz_pq{xyz_p[0] - xyz_q[0], xyz_p[1] - xyz_q[1],
                                                 xyz_p[2] - xyz_q[2]};

                    double alpha = p * q / (p + q);
                    double dx{xyz_pq[0]}, dy{xyz_pq[1]}, dz{xyz_pq[2]};
                    double x = alpha * (dx * dx + dy * dy + dz * dz);
                    boys_f.calcFnx(x, &fnx[0]);

                    double fac = (2.0 * std::pow(M_PI, 2.5) / (p * q * std::sqrt(p + q)));
                    calcRInts<lab, lcd>(alpha, fac, &fnx[0], &xyz_pq[0], &rints[0]);

                    const double* p_ecoeffs_cd_tsp = &ecoeffs_cd_tsp[icd * n_ecoeffs_cd];
                    double* p_rints_x_ecoeffs = &rints_x_ecoeffs[pos_rints_x_ecoeffs];

                    p_rints_x_ecoeffs[0] += rints[2] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[0] += rints[7] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[0] += rints[0] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[0] += rints[1] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[0] += rints[9] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[0] += rints[4] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[0] += rints[3] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[1] += rints[1] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[1] += rints[0] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[1] += rints[3] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[1] += rints[6] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[2] += rints[0] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[2] += rints[3] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[2] += rints[2] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[2] += rints[8] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[3] += rints[2] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[3] += rints[7] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[3] += rints[0] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[3] += rints[1] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[3] += rints[4] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[4] += rints[1] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[4] += rints[0] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[4] += rints[5] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[4] += rints[2] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[5] += rints[12] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[5] += rints[17] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[5] += rints[10] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[5] += rints[11] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[5] += rints[19] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[5] += rints[14] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[5] += rints[13] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[6] += rints[11] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[6] += rints[10] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[6] += rints[13] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[6] += rints[16] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[7] += rints[10] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[7] += rints[13] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[7] += rints[12] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[7] += rints[18] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[8] += rints[12] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[8] += rints[17] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[8] += rints[10] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[8] += rints[11] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[8] += rints[14] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[9] += rints[11] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[9] += rints[10] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[9] += rints[15] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[9] += rints[12] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[10] += rints[22] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[10] += rints[27] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[10] += rints[20] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[10] += rints[21] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[10] += rints[29] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[10] += rints[24] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[10] += rints[23] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[11] += rints[21] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[11] += rints[20] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[11] += rints[23] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[11] += rints[26] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[12] += rints[20] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[12] += rints[23] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[12] += rints[22] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[12] += rints[28] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[13] += rints[22] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[13] += rints[27] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[13] += rints[20] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[13] += rints[21] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[13] += rints[24] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[14] += rints[21] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[14] += rints[20] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[14] += rints[25] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[14] += rints[22] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[15] += rints[32] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[15] += rints[37] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[15] += rints[30] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[15] += rints[31] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[15] += rints[39] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[15] += rints[34] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[15] += rints[33] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[16] += rints[31] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[16] += rints[30] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[16] += rints[33] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[16] += rints[36] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[17] += rints[30] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[17] += rints[33] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[17] += rints[32] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[17] += rints[38] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[18] += rints[32] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[18] += rints[37] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[18] += rints[30] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[18] += rints[31] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[18] += rints[34] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[19] += rints[31] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[19] += rints[30] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[19] += rints[35] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[19] += rints[32] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[20] += rints[42] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[20] += rints[47] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[20] += rints[40] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[20] += rints[41] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[20] += rints[49] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[20] += rints[44] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[20] += rints[43] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[21] += rints[41] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[21] += rints[40] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[21] += rints[43] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[21] += rints[46] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[22] += rints[40] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[22] += rints[43] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[22] += rints[42] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[22] += rints[48] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[23] += rints[42] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[23] += rints[47] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[23] += rints[40] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[23] += rints[41] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[23] += rints[44] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[24] += rints[41] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[24] += rints[40] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[24] += rints[45] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[24] += rints[42] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[25] += rints[52] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[25] += rints[57] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[25] += rints[50] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[25] += rints[51] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[25] += rints[59] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[25] += rints[54] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[25] += rints[53] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[26] += rints[51] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[26] += rints[50] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[26] += rints[53] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[26] += rints[56] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[27] += rints[50] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[27] += rints[53] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[27] += rints[52] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[27] += rints[58] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[28] += rints[52] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[28] += rints[57] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[28] += rints[50] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[28] += rints[51] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[28] += rints[54] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[29] += rints[51] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[29] += rints[50] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[29] += rints[55] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[29] += rints[52] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[30] += rints[62] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[30] += rints[67] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[30] += rints[60] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[30] += rints[61] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[30] += rints[69] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[30] += rints[64] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[30] += rints[63] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[31] += rints[61] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[31] += rints[60] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[31] += rints[63] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[31] += rints[66] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[32] += rints[60] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[32] += rints[63] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[32] += rints[62] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[32] += rints[68] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[33] += rints[62] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[33] += rints[67] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[33] += rints[60] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[33] += rints[61] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[33] += rints[64] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[34] += rints[61] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[34] += rints[60] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[34] += rints[65] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[34] += rints[62] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[35] += rints[72] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[35] += rints[77] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[35] += rints[70] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[35] += rints[71] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[35] += rints[79] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[35] += rints[74] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[35] += rints[73] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[36] += rints[71] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[36] += rints[70] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[36] += rints[73] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[36] += rints[76] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[37] += rints[70] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[37] += rints[73] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[37] += rints[72] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[37] += rints[78] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[38] += rints[72] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[38] += rints[77] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[38] += rints[70] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[38] += rints[71] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[38] += rints[74] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[39] += rints[71] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[39] += rints[70] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[39] += rints[75] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[39] += rints[72] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[40] += rints[82] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[40] += rints[87] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[40] += rints[80] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[40] += rints[81] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[40] += rints[89] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[40] += rints[84] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[40] += rints[83] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[41] += rints[81] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[41] += rints[80] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[41] += rints[83] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[41] += rints[86] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[42] += rints[80] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[42] += rints[83] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[42] += rints[82] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[42] += rints[88] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[43] += rints[82] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[43] += rints[87] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[43] += rints[80] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[43] += rints[81] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[43] += rints[84] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[44] += rints[81] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[44] += rints[80] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[44] += rints[85] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[44] += rints[82] * p_ecoeffs_cd_tsp[14];
                    p_rints_x_ecoeffs[45] += rints[92] * p_ecoeffs_cd_tsp[10];
                    p_rints_x_ecoeffs[45] += rints[97] * p_ecoeffs_cd_tsp[35];
                    p_rints_x_ecoeffs[45] += rints[90] * p_ecoeffs_cd_tsp[0];
                    p_rints_x_ecoeffs[45] += rints[91] * p_ecoeffs_cd_tsp[5];
                    p_rints_x_ecoeffs[45] += rints[99] * p_ecoeffs_cd_tsp[45];
                    p_rints_x_ecoeffs[45] += rints[94] * p_ecoeffs_cd_tsp[20];
                    p_rints_x_ecoeffs[45] += rints[93] * p_ecoeffs_cd_tsp[15];
                    p_rints_x_ecoeffs[46] += rints[91] * p_ecoeffs_cd_tsp[6];
                    p_rints_x_ecoeffs[46] += rints[90] * p_ecoeffs_cd_tsp[1];
                    p_rints_x_ecoeffs[46] += rints[93] * p_ecoeffs_cd_tsp[16];
                    p_rints_x_ecoeffs[46] += rints[96] * p_ecoeffs_cd_tsp[31];
                    p_rints_x_ecoeffs[47] += rints[90] * p_ecoeffs_cd_tsp[2];
                    p_rints_x_ecoeffs[47] += rints[93] * p_ecoeffs_cd_tsp[17];
                    p_rints_x_ecoeffs[47] += rints[92] * p_ecoeffs_cd_tsp[12];
                    p_rints_x_ecoeffs[47] += rints[98] * p_ecoeffs_cd_tsp[42];
                    p_rints_x_ecoeffs[48] += rints[92] * p_ecoeffs_cd_tsp[13];
                    p_rints_x_ecoeffs[48] += rints[97] * p_ecoeffs_cd_tsp[38];
                    p_rints_x_ecoeffs[48] += rints[90] * p_ecoeffs_cd_tsp[3];
                    p_rints_x_ecoeffs[48] += rints[91] * p_ecoeffs_cd_tsp[8];
                    p_rints_x_ecoeffs[48] += rints[94] * p_ecoeffs_cd_tsp[23];
                    p_rints_x_ecoeffs[49] += rints[91] * p_ecoeffs_cd_tsp[9];
                    p_rints_x_ecoeffs[49] += rints[90] * p_ecoeffs_cd_tsp[4];
                    p_rints_x_ecoeffs[49] += rints[95] * p_ecoeffs_cd_tsp[29];
                    p_rints_x_ecoeffs[49] += rints[92] * p_ecoeffs_cd_tsp[14];
                }
        }

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            const double* p_ecoeffs_ab = &ecoeffs_ab[iab * n_ecoeffs_ab];
            const double* p_rints_x_ecoeffs = &rints_x_ecoeffs[iab * n_rints_x_ecoeffs];

            eri4_batch[0] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[10];
            eri4_batch[0] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[35];
            eri4_batch[0] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[0];
            eri4_batch[0] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[5];
            eri4_batch[0] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[45];
            eri4_batch[0] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[20];
            eri4_batch[0] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[15];
            eri4_batch[1] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[11];
            eri4_batch[1] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[36];
            eri4_batch[1] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[1];
            eri4_batch[1] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[6];
            eri4_batch[1] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[46];
            eri4_batch[1] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[21];
            eri4_batch[1] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[16];
            eri4_batch[2] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[12];
            eri4_batch[2] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[37];
            eri4_batch[2] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[2];
            eri4_batch[2] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[7];
            eri4_batch[2] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[47];
            eri4_batch[2] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[22];
            eri4_batch[2] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[17];
            eri4_batch[3] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[13];
            eri4_batch[3] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[38];
            eri4_batch[3] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[3];
            eri4_batch[3] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[8];
            eri4_batch[3] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[48];
            eri4_batch[3] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[23];
            eri4_batch[3] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[18];
            eri4_batch[4] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[14];
            eri4_batch[4] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[39];
            eri4_batch[4] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[4];
            eri4_batch[4] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[9];
            eri4_batch[4] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[49];
            eri4_batch[4] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[24];
            eri4_batch[4] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[19];
            eri4_batch[5] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[5];
            eri4_batch[5] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[0];
            eri4_batch[5] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[15];
            eri4_batch[5] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[30];
            eri4_batch[6] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[6];
            eri4_batch[6] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[1];
            eri4_batch[6] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[16];
            eri4_batch[6] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[31];
            eri4_batch[7] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[7];
            eri4_batch[7] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[2];
            eri4_batch[7] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[17];
            eri4_batch[7] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[32];
            eri4_batch[8] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[8];
            eri4_batch[8] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[3];
            eri4_batch[8] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[18];
            eri4_batch[8] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[33];
            eri4_batch[9] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[9];
            eri4_batch[9] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[4];
            eri4_batch[9] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[19];
            eri4_batch[9] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[34];
            eri4_batch[10] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[0];
            eri4_batch[10] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[15];
            eri4_batch[10] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[10];
            eri4_batch[10] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[40];
            eri4_batch[11] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[1];
            eri4_batch[11] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[16];
            eri4_batch[11] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[11];
            eri4_batch[11] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[41];
            eri4_batch[12] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[2];
            eri4_batch[12] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[17];
            eri4_batch[12] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[12];
            eri4_batch[12] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[42];
            eri4_batch[13] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[3];
            eri4_batch[13] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[18];
            eri4_batch[13] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[13];
            eri4_batch[13] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[43];
            eri4_batch[14] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[4];
            eri4_batch[14] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[19];
            eri4_batch[14] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[14];
            eri4_batch[14] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[44];
            eri4_batch[15] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[10];
            eri4_batch[15] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[35];
            eri4_batch[15] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[0];
            eri4_batch[15] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[5];
            eri4_batch[15] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[20];
            eri4_batch[16] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[11];
            eri4_batch[16] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[36];
            eri4_batch[16] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[1];
            eri4_batch[16] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[6];
            eri4_batch[16] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[21];
            eri4_batch[17] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[12];
            eri4_batch[17] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[37];
            eri4_batch[17] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[2];
            eri4_batch[17] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[7];
            eri4_batch[17] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[22];
            eri4_batch[18] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[13];
            eri4_batch[18] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[38];
            eri4_batch[18] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[3];
            eri4_batch[18] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[8];
            eri4_batch[18] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[23];
            eri4_batch[19] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[14];
            eri4_batch[19] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[39];
            eri4_batch[19] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[4];
            eri4_batch[19] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[9];
            eri4_batch[19] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[24];
            eri4_batch[20] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[5];
            eri4_batch[20] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[0];
            eri4_batch[20] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[25];
            eri4_batch[20] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[10];
            eri4_batch[21] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[6];
            eri4_batch[21] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[1];
            eri4_batch[21] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[26];
            eri4_batch[21] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[11];
            eri4_batch[22] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[7];
            eri4_batch[22] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[2];
            eri4_batch[22] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[27];
            eri4_batch[22] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[12];
            eri4_batch[23] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[8];
            eri4_batch[23] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[3];
            eri4_batch[23] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[28];
            eri4_batch[23] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[13];
            eri4_batch[24] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[9];
            eri4_batch[24] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[4];
            eri4_batch[24] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[29];
            eri4_batch[24] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[14];
        }
}

template<> void lible::ints::two::eri3Kernel<1, 1, 2>(const int cdepth_a, const int cdepth_b, const int cdepth_c,
                                                      const double* exps_a, const double* exps_b,
                                                      const double* exps_c, const double* coords_a,
                                                      const double* coords_b, const double* coords_c,
                                                      const double* ecoeffs_ab, const double* ecoeffs_c,
                                                      double* eri3_batch)
{
    constexpr int la = 1, lb = 1, lc = 2;
    constexpr int lab = la + lb;
    constexpr int labc = lab + lc;
    constexpr int n_sph_a = numSphericalsC(la);
    constexpr int n_sph_b = numSphericalsC(lb);
    constexpr int n_sph_c = numSphericalsC(lc);
    constexpr int n_hermite_ab = numHermitesC(lab);
    constexpr int n_hermite_c = numHermitesC(lc);
    constexpr int n_sph_ab = n_sph_a * n_sph_b;
    constexpr int n_ecoeffs_ab = n_sph_ab * n_hermite_ab;
    constexpr int n_ecoeffs_c = n_sph_c * n_hermite_c;

    std::fill(eri3_batch, eri3_batch + n_sph_ab * n_sph_c, 0);

    std::array<double, labc + 1> fnx;
    BoysF2<labc> boys_f;

    constexpr int n_hermites_abc = numHermitesC(lab) * numHermitesC(lc);
    std::array<double, n_hermites_abc> rints;

    constexpr int n_rints_x_ecoeffs = n_sph_c * n_hermite_ab;
    std::vector<double> rints_x_ecoeffs(cdepth_a * cdepth_b * n_rints_x_ecoeffs, 0);

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            int pos_rints_x_ecoeffs = iab * n_rints_x_ecoeffs;
            for (int ic = 0; ic < cdepth_c; ic++)
            {
                double a = exps_a[ia];
                double b = exps_b[ib];
                double c = exps_c[ic];

                double p = a + b;
                double alpha = p * c / (p + c);

                std::array<double, 3> xyz_p{(a * coords_a[0] + b * coords_b[0]) / p,
                                            (a * coords_a[1] + b * coords_b[1]) / p,
                                            (a * coords_a[2] + b * coords_b[2]) / p};

                std::array<double, 3> xyz_pc{xyz_p[0] - coords_c[0],
                                             xyz_p[1] - coords_c[1],
                                             xyz_p[2] - coords_c[2]};

                double dx{xyz_pc[0]}, dy{xyz_pc[1]}, dz{xyz_pc[2]};
                double x = alpha * (dx * dx + dy * dy + dz * dz);
                boys_f.calcFnx(x, &fnx[0]);

                double fac = (2.0 * std::pow(M_PI, 2.5) / (p * c * std::sqrt(p + c)));
                calcRInts<lab, lc>(alpha, fac, &fnx[0], &xyz_pc[0], &rints[0]);

                    const double* p_ecoeffs_c = &ecoeffs_c[ic * n_ecoeffs_c];
                    double* p_rints_x_ecoeffs = &rints_x_ecoeffs[pos_rints_x_ecoeffs];

                    p_rints_x_ecoeffs[0] += rints[2] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[0] += rints[7] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[0] += rints[0] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[0] += rints[1] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[0] += rints[9] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[0] += rints[4] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[0] += rints[3] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[1] += rints[1] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[1] += rints[0] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[1] += rints[3] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[1] += rints[6] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[2] += rints[0] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[2] += rints[3] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[2] += rints[2] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[2] += rints[8] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[3] += rints[2] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[3] += rints[7] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[3] += rints[0] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[3] += rints[1] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[3] += rints[4] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[4] += rints[1] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[4] += rints[0] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[4] += rints[5] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[4] += rints[2] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[5] += rints[12] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[5] += rints[17] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[5] += rints[10] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[5] += rints[11] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[5] += rints[19] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[5] += rints[14] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[5] += rints[13] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[6] += rints[11] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[6] += rints[10] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[6] += rints[13] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[6] += rints[16] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[7] += rints[10] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[7] += rints[13] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[7] += rints[12] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[7] += rints[18] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[8] += rints[12] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[8] += rints[17] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[8] += rints[10] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[8] += rints[11] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[8] += rints[14] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[9] += rints[11] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[9] += rints[10] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[9] += rints[15] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[9] += rints[12] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[10] += rints[22] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[10] += rints[27] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[10] += rints[20] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[10] += rints[21] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[10] += rints[29] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[10] += rints[24] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[10] += rints[23] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[11] += rints[21] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[11] += rints[20] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[11] += rints[23] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[11] += rints[26] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[12] += rints[20] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[12] += rints[23] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[12] += rints[22] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[12] += rints[28] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[13] += rints[22] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[13] += rints[27] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[13] += rints[20] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[13] += rints[21] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[13] += rints[24] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[14] += rints[21] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[14] += rints[20] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[14] += rints[25] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[14] += rints[22] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[15] += rints[32] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[15] += rints[37] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[15] += rints[30] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[15] += rints[31] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[15] += rints[39] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[15] += rints[34] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[15] += rints[33] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[16] += rints[31] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[16] += rints[30] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[16] += rints[33] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[16] += rints[36] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[17] += rints[30] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[17] += rints[33] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[17] += rints[32] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[17] += rints[38] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[18] += rints[32] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[18] += rints[37] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[18] += rints[30] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[18] += rints[31] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[18] += rints[34] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[19] += rints[31] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[19] += rints[30] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[19] += rints[35] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[19] += rints[32] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[20] += rints[42] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[20] += rints[47] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[20] += rints[40] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[20] += rints[41] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[20] += rints[49] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[20] += rints[44] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[20] += rints[43] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[21] += rints[41] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[21] += rints[40] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[21] += rints[43] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[21] += rints[46] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[22] += rints[40] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[22] += rints[43] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[22] += rints[42] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[22] += rints[48] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[23] += rints[42] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[23] += rints[47] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[23] += rints[40] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[23] += rints[41] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[23] += rints[44] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[24] += rints[41] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[24] += rints[40] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[24] += rints[45] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[24] += rints[42] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[25] += rints[52] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[25] += rints[57] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[25] += rints[50] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[25] += rints[51] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[25] += rints[59] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[25] += rints[54] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[25] += rints[53] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[26] += rints[51] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[26] += rints[50] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[26] += rints[53] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[26] += rints[56] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[27] += rints[50] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[27] += rints[53] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[27] += rints[52] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[27] += rints[58] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[28] += rints[52] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[28] += rints[57] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[28] += rints[50] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[28] += rints[51] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[28] += rints[54] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[29] += rints[51] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[29] += rints[50] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[29] += rints[55] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[29] += rints[52] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[30] += rints[62] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[30] += rints[67] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[30] += rints[60] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[30] += rints[61] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[30] += rints[69] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[30] += rints[64] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[30] += rints[63] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[31] += rints[61] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[31] += rints[60] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[31] += rints[63] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[31] += rints[66] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[32] += rints[60] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[32] += rints[63] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[32] += rints[62] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[32] += rints[68] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[33] += rints[62] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[33] += rints[67] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[33] += rints[60] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[33] += rints[61] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[33] += rints[64] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[34] += rints[61] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[34] += rints[60] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[34] += rints[65] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[34] += rints[62] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[35] += rints[72] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[35] += rints[77] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[35] += rints[70] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[35] += rints[71] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[35] += rints[79] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[35] += rints[74] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[35] += rints[73] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[36] += rints[71] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[36] += rints[70] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[36] += rints[73] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[36] += rints[76] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[37] += rints[70] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[37] += rints[73] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[37] += rints[72] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[37] += rints[78] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[38] += rints[72] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[38] += rints[77] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[38] += rints[70] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[38] += rints[71] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[38] += rints[74] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[39] += rints[71] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[39] += rints[70] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[39] += rints[75] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[39] += rints[72] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[40] += rints[82] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[40] += rints[87] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[40] += rints[80] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[40] += rints[81] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[40] += rints[89] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[40] += rints[84] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[40] += rints[83] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[41] += rints[81] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[41] += rints[80] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[41] += rints[83] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[41] += rints[86] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[42] += rints[80] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[42] += rints[83] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[42] += rints[82] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[42] += rints[88] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[43] += rints[82] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[43] += rints[87] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[43] += rints[80] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[43] += rints[81] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[43] += rints[84] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[44] += rints[81] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[44] += rints[80] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[44] += rints[85] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[44] += rints[82] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[45] += rints[92] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[45] += rints[97] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[45] += rints[90] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[45] += rints[91] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[45] += rints[99] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[45] += rints[94] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[45] += rints[93] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[46] += rints[91] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[46] += rints[90] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[46] += rints[93] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[46] += rints[96] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[47] += rints[90] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[47] += rints[93] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[47] += rints[92] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[47] += rints[98] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[48] += rints[92] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[48] += rints[97] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[48] += rints[90] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[48] += rints[91] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[48] += rints[94] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[49] += rints[91] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[49] += rints[90] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[49] += rints[95] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[49] += rints[92] * p_ecoeffs_c[42];
            }
}

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            const double* p_ecoeffs_ab = &ecoeffs_ab[iab * n_ecoeffs_ab];
            const double* p_rints_x_ecoeffs = &rints_x_ecoeffs[iab * n_rints_x_ecoeffs];

            eri3_batch[0] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[0];
            eri3_batch[0] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[15];
            eri3_batch[0] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[45];
            eri3_batch[1] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[1];
            eri3_batch[1] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[16];
            eri3_batch[1] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[46];
            eri3_batch[2] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[2];
            eri3_batch[2] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[17];
            eri3_batch[2] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[47];
            eri3_batch[3] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[3];
            eri3_batch[3] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[18];
            eri3_batch[3] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[48];
            eri3_batch[4] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[4];
            eri3_batch[4] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[19];
            eri3_batch[4] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[49];
            eri3_batch[5] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[5];
            eri3_batch[5] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[0];
            eri3_batch[5] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[15];
            eri3_batch[5] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[30];
            eri3_batch[6] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[6];
            eri3_batch[6] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[1];
            eri3_batch[6] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[16];
            eri3_batch[6] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[31];
            eri3_batch[7] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[7];
            eri3_batch[7] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[2];
            eri3_batch[7] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[17];
            eri3_batch[7] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[32];
            eri3_batch[8] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[8];
            eri3_batch[8] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[3];
            eri3_batch[8] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[18];
            eri3_batch[8] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[33];
            eri3_batch[9] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[9];
            eri3_batch[9] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[4];
            eri3_batch[9] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[19];
            eri3_batch[9] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[34];
            eri3_batch[10] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[0];
            eri3_batch[10] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[15];
            eri3_batch[10] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[10];
            eri3_batch[10] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[40];
            eri3_batch[11] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[1];
            eri3_batch[11] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[16];
            eri3_batch[11] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[11];
            eri3_batch[11] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[41];
            eri3_batch[12] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[2];
            eri3_batch[12] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[17];
            eri3_batch[12] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[12];
            eri3_batch[12] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[42];
            eri3_batch[13] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[3];
            eri3_batch[13] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[18];
            eri3_batch[13] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[13];
            eri3_batch[13] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[43];
            eri3_batch[14] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[4];
            eri3_batch[14] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[19];
            eri3_batch[14] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[14];
            eri3_batch[14] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[44];
            eri3_batch[15] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[5];
            eri3_batch[15] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[0];
            eri3_batch[15] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[15];
            eri3_batch[15] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[30];
            eri3_batch[16] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[6];
            eri3_batch[16] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[1];
            eri3_batch[16] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[16];
            eri3_batch[16] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[31];
            eri3_batch[17] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[7];
            eri3_batch[17] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[2];
            eri3_batch[17] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[17];
            eri3_batch[17] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[32];
            eri3_batch[18] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[8];
            eri3_batch[18] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[3];
            eri3_batch[18] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[18];
            eri3_batch[18] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[33];
            eri3_batch[19] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[9];
            eri3_batch[19] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[4];
            eri3_batch[19] += p_ecoeffs_ab[33] * p_rints_x_ecoeffs[19];
            eri3_batch[19] += p_ecoeffs_ab[36] * p_rints_x_ecoeffs[34];
            eri3_batch[20] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[5];
            eri3_batch[20] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[0];
            eri3_batch[20] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[20];
            eri3_batch[21] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[6];
            eri3_batch[21] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[1];
            eri3_batch[21] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[21];
            eri3_batch[22] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[7];
            eri3_batch[22] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[2];
            eri3_batch[22] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[22];
            eri3_batch[23] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[8];
            eri3_batch[23] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[3];
            eri3_batch[23] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[23];
            eri3_batch[24] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[9];
            eri3_batch[24] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[4];
            eri3_batch[24] += p_ecoeffs_ab[44] * p_rints_x_ecoeffs[24];
            eri3_batch[25] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[5];
            eri3_batch[25] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[0];
            eri3_batch[25] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[25];
            eri3_batch[25] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[10];
            eri3_batch[26] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[6];
            eri3_batch[26] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[1];
            eri3_batch[26] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[26];
            eri3_batch[26] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[11];
            eri3_batch[27] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[7];
            eri3_batch[27] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[2];
            eri3_batch[27] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[27];
            eri3_batch[27] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[12];
            eri3_batch[28] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[8];
            eri3_batch[28] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[3];
            eri3_batch[28] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[28];
            eri3_batch[28] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[13];
            eri3_batch[29] += p_ecoeffs_ab[51] * p_rints_x_ecoeffs[9];
            eri3_batch[29] += p_ecoeffs_ab[50] * p_rints_x_ecoeffs[4];
            eri3_batch[29] += p_ecoeffs_ab[55] * p_rints_x_ecoeffs[29];
            eri3_batch[29] += p_ecoeffs_ab[52] * p_rints_x_ecoeffs[14];
            eri3_batch[30] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[0];
            eri3_batch[30] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[15];
            eri3_batch[30] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[10];
            eri3_batch[30] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[40];
            eri3_batch[31] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[1];
            eri3_batch[31] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[16];
            eri3_batch[31] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[11];
            eri3_batch[31] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[41];
            eri3_batch[32] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[2];
            eri3_batch[32] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[17];
            eri3_batch[32] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[12];
            eri3_batch[32] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[42];
            eri3_batch[33] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[3];
            eri3_batch[33] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[18];
            eri3_batch[33] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[13];
            eri3_batch[33] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[43];
            eri3_batch[34] += p_ecoeffs_ab[60] * p_rints_x_ecoeffs[4];
            eri3_batch[34] += p_ecoeffs_ab[63] * p_rints_x_ecoeffs[19];
            eri3_batch[34] += p_ecoeffs_ab[62] * p_rints_x_ecoeffs[14];
            eri3_batch[34] += p_ecoeffs_ab[68] * p_rints_x_ecoeffs[44];
            eri3_batch[35] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[5];
            eri3_batch[35] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[0];
            eri3_batch[35] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[25];
            eri3_batch[35] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[10];
            eri3_batch[36] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[6];
            eri3_batch[36] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[1];
            eri3_batch[36] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[26];
            eri3_batch[36] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[11];
            eri3_batch[37] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[7];
            eri3_batch[37] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[2];
            eri3_batch[37] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[27];
            eri3_batch[37] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[12];
            eri3_batch[38] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[8];
            eri3_batch[38] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[3];
            eri3_batch[38] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[28];
            eri3_batch[38] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[13];
            eri3_batch[39] += p_ecoeffs_ab[71] * p_rints_x_ecoeffs[9];
            eri3_batch[39] += p_ecoeffs_ab[70] * p_rints_x_ecoeffs[4];
            eri3_batch[39] += p_ecoeffs_ab[75] * p_rints_x_ecoeffs[29];
            eri3_batch[39] += p_ecoeffs_ab[72] * p_rints_x_ecoeffs[14];
            eri3_batch[40] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[35];
            eri3_batch[40] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[0];
            eri3_batch[40] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[10];
            eri3_batch[41] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[36];
            eri3_batch[41] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[1];
            eri3_batch[41] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[11];
            eri3_batch[42] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[37];
            eri3_batch[42] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[2];
            eri3_batch[42] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[12];
            eri3_batch[43] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[38];
            eri3_batch[43] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[3];
            eri3_batch[43] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[13];
            eri3_batch[44] += p_ecoeffs_ab[87] * p_rints_x_ecoeffs[39];
            eri3_batch[44] += p_ecoeffs_ab[80] * p_rints_x_ecoeffs[4];
            eri3_batch[44] += p_ecoeffs_ab[82] * p_rints_x_ecoeffs[14];
        }
}

template<> void lible::ints::two::eri3Kernel<2, 0, 2>(const int cdepth_a, const int cdepth_b, const int cdepth_c,
                                                      const double* exps_a, const double* exps_b,
                                                      const double* exps_c, const double* coords_a,
                                                      const double* coords_b, const double* coords_c,
                                                      const double* ecoeffs_ab, const double* ecoeffs_c,
                                                      double* eri3_batch)
{
    constexpr int la = 2, lb = 0, lc = 2;
    constexpr int lab = la + lb;
    constexpr int labc = lab + lc;
    constexpr int n_sph_a = numSphericalsC(la);
    constexpr int n_sph_b = numSphericalsC(lb);
    constexpr int n_sph_c = numSphericalsC(lc);
    constexpr int n_hermite_ab = numHermitesC(lab);
    constexpr int n_hermite_c = numHermitesC(lc);
    constexpr int n_sph_ab = n_sph_a * n_sph_b;
    constexpr int n_ecoeffs_ab = n_sph_ab * n_hermite_ab;
    constexpr int n_ecoeffs_c = n_sph_c * n_hermite_c;

    std::fill(eri3_batch, eri3_batch + n_sph_ab * n_sph_c, 0);

    std::array<double, labc + 1> fnx;
    BoysF2<labc> boys_f;

    constexpr int n_hermites_abc = numHermitesC(lab) * numHermitesC(lc);
    std::array<double, n_hermites_abc> rints;

    constexpr int n_rints_x_ecoeffs = n_sph_c * n_hermite_ab;
    std::vector<double> rints_x_ecoeffs(cdepth_a * cdepth_b * n_rints_x_ecoeffs, 0);

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            int pos_rints_x_ecoeffs = iab * n_rints_x_ecoeffs;
            for (int ic = 0; ic < cdepth_c; ic++)
            {
                double a = exps_a[ia];
                double b = exps_b[ib];
                double c = exps_c[ic];

                double p = a + b;
                double alpha = p * c / (p + c);

                std::array<double, 3> xyz_p{(a * coords_a[0] + b * coords_b[0]) / p,
                                            (a * coords_a[1] + b * coords_b[1]) / p,
                                            (a * coords_a[2] + b * coords_b[2]) / p};

                std::array<double, 3> xyz_pc{xyz_p[0] - coords_c[0],
                                             xyz_p[1] - coords_c[1],
                                             xyz_p[2] - coords_c[2]};

                double dx{xyz_pc[0]}, dy{xyz_pc[1]}, dz{xyz_pc[2]};
                double x = alpha * (dx * dx + dy * dy + dz * dz);
                boys_f.calcFnx(x, &fnx[0]);

                double fac = (2.0 * std::pow(M_PI, 2.5) / (p * c * std::sqrt(p + c)));
                calcRInts<lab, lc>(alpha, fac, &fnx[0], &xyz_pc[0], &rints[0]);

                    const double* p_ecoeffs_c = &ecoeffs_c[ic * n_ecoeffs_c];
                    double* p_rints_x_ecoeffs = &rints_x_ecoeffs[pos_rints_x_ecoeffs];

                    p_rints_x_ecoeffs[0] += rints[2] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[0] += rints[7] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[0] += rints[0] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[0] += rints[1] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[0] += rints[9] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[0] += rints[4] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[0] += rints[3] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[1] += rints[1] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[1] += rints[0] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[1] += rints[3] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[1] += rints[6] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[2] += rints[0] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[2] += rints[3] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[2] += rints[2] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[2] += rints[8] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[3] += rints[2] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[3] += rints[7] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[3] += rints[0] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[3] += rints[1] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[3] += rints[4] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[4] += rints[1] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[4] += rints[0] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[4] += rints[5] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[4] += rints[2] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[5] += rints[12] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[5] += rints[17] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[5] += rints[10] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[5] += rints[11] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[5] += rints[19] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[5] += rints[14] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[5] += rints[13] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[6] += rints[11] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[6] += rints[10] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[6] += rints[13] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[6] += rints[16] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[7] += rints[10] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[7] += rints[13] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[7] += rints[12] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[7] += rints[18] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[8] += rints[12] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[8] += rints[17] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[8] += rints[10] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[8] += rints[11] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[8] += rints[14] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[9] += rints[11] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[9] += rints[10] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[9] += rints[15] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[9] += rints[12] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[10] += rints[22] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[10] += rints[27] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[10] += rints[20] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[10] += rints[21] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[10] += rints[29] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[10] += rints[24] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[10] += rints[23] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[11] += rints[21] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[11] += rints[20] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[11] += rints[23] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[11] += rints[26] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[12] += rints[20] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[12] += rints[23] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[12] += rints[22] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[12] += rints[28] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[13] += rints[22] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[13] += rints[27] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[13] += rints[20] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[13] += rints[21] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[13] += rints[24] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[14] += rints[21] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[14] += rints[20] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[14] += rints[25] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[14] += rints[22] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[15] += rints[32] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[15] += rints[37] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[15] += rints[30] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[15] += rints[31] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[15] += rints[39] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[15] += rints[34] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[15] += rints[33] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[16] += rints[31] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[16] += rints[30] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[16] += rints[33] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[16] += rints[36] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[17] += rints[30] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[17] += rints[33] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[17] += rints[32] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[17] += rints[38] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[18] += rints[32] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[18] += rints[37] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[18] += rints[30] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[18] += rints[31] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[18] += rints[34] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[19] += rints[31] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[19] += rints[30] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[19] += rints[35] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[19] += rints[32] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[20] += rints[42] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[20] += rints[47] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[20] += rints[40] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[20] += rints[41] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[20] += rints[49] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[20] += rints[44] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[20] += rints[43] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[21] += rints[41] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[21] += rints[40] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[21] += rints[43] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[21] += rints[46] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[22] += rints[40] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[22] += rints[43] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[22] += rints[42] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[22] += rints[48] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[23] += rints[42] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[23] += rints[47] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[23] += rints[40] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[23] += rints[41] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[23] += rints[44] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[24] += rints[41] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[24] += rints[40] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[24] += rints[45] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[24] += rints[42] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[25] += rints[52] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[25] += rints[57] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[25] += rints[50] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[25] += rints[51] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[25] += rints[59] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[25] += rints[54] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[25] += rints[53] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[26] += rints[51] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[26] += rints[50] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[26] += rints[53] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[26] += rints[56] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[27] += rints[50] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[27] += rints[53] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[27] += rints[52] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[27] += rints[58] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[28] += rints[52] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[28] += rints[57] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[28] += rints[50] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[28] += rints[51] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[28] += rints[54] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[29] += rints[51] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[29] += rints[50] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[29] += rints[55] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[29] += rints[52] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[30] += rints[62] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[30] += rints[67] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[30] += rints[60] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[30] += rints[61] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[30] += rints[69] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[30] += rints[64] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[30] += rints[63] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[31] += rints[61] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[31] += rints[60] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[31] += rints[63] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[31] += rints[66] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[32] += rints[60] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[32] += rints[63] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[32] += rints[62] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[32] += rints[68] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[33] += rints[62] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[33] += rints[67] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[33] += rints[60] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[33] += rints[61] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[33] += rints[64] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[34] += rints[61] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[34] += rints[60] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[34] += rints[65] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[34] += rints[62] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[35] += rints[72] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[35] += rints[77] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[35] += rints[70] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[35] += rints[71] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[35] += rints[79] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[35] += rints[74] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[35] += rints[73] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[36] += rints[71] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[36] += rints[70] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[36] += rints[73] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[36] += rints[76] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[37] += rints[70] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[37] += rints[73] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[37] += rints[72] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[37] += rints[78] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[38] += rints[72] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[38] += rints[77] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[38] += rints[70] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[38] += rints[71] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[38] += rints[74] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[39] += rints[71] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[39] += rints[70] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[39] += rints[75] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[39] += rints[72] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[40] += rints[82] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[40] += rints[87] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[40] += rints[80] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[40] += rints[81] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[40] += rints[89] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[40] += rints[84] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[40] += rints[83] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[41] += rints[81] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[41] += rints[80] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[41] += rints[83] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[41] += rints[86] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[42] += rints[80] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[42] += rints[83] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[42] += rints[82] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[42] += rints[88] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[43] += rints[82] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[43] += rints[87] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[43] += rints[80] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[43] += rints[81] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[43] += rints[84] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[44] += rints[81] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[44] += rints[80] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[44] += rints[85] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[44] += rints[82] * p_ecoeffs_c[42];
                    p_rints_x_ecoeffs[45] += rints[92] * p_ecoeffs_c[2];
                    p_rints_x_ecoeffs[45] += rints[97] * p_ecoeffs_c[7];
                    p_rints_x_ecoeffs[45] += rints[90] * p_ecoeffs_c[0];
                    p_rints_x_ecoeffs[45] += rints[91] * p_ecoeffs_c[1];
                    p_rints_x_ecoeffs[45] += rints[99] * p_ecoeffs_c[9];
                    p_rints_x_ecoeffs[45] += rints[94] * p_ecoeffs_c[4];
                    p_rints_x_ecoeffs[45] += rints[93] * p_ecoeffs_c[3];
                    p_rints_x_ecoeffs[46] += rints[91] * p_ecoeffs_c[11];
                    p_rints_x_ecoeffs[46] += rints[90] * p_ecoeffs_c[10];
                    p_rints_x_ecoeffs[46] += rints[93] * p_ecoeffs_c[13];
                    p_rints_x_ecoeffs[46] += rints[96] * p_ecoeffs_c[16];
                    p_rints_x_ecoeffs[47] += rints[90] * p_ecoeffs_c[20];
                    p_rints_x_ecoeffs[47] += rints[93] * p_ecoeffs_c[23];
                    p_rints_x_ecoeffs[47] += rints[92] * p_ecoeffs_c[22];
                    p_rints_x_ecoeffs[47] += rints[98] * p_ecoeffs_c[28];
                    p_rints_x_ecoeffs[48] += rints[92] * p_ecoeffs_c[32];
                    p_rints_x_ecoeffs[48] += rints[97] * p_ecoeffs_c[37];
                    p_rints_x_ecoeffs[48] += rints[90] * p_ecoeffs_c[30];
                    p_rints_x_ecoeffs[48] += rints[91] * p_ecoeffs_c[31];
                    p_rints_x_ecoeffs[48] += rints[94] * p_ecoeffs_c[34];
                    p_rints_x_ecoeffs[49] += rints[91] * p_ecoeffs_c[41];
                    p_rints_x_ecoeffs[49] += rints[90] * p_ecoeffs_c[40];
                    p_rints_x_ecoeffs[49] += rints[95] * p_ecoeffs_c[45];
                    p_rints_x_ecoeffs[49] += rints[92] * p_ecoeffs_c[42];
            }
}

    for (int ia = 0, iab = 0; ia < cdepth_a; ia++)
        for (int ib = 0; ib < cdepth_b; ib++, iab++)
        {
            const double* p_ecoeffs_ab = &ecoeffs_ab[iab * n_ecoeffs_ab];
            const double* p_rints_x_ecoeffs = &rints_x_ecoeffs[iab * n_rints_x_ecoeffs];

            eri3_batch[0] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[10];
            eri3_batch[0] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[35];
            eri3_batch[0] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[0];
            eri3_batch[0] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[5];
            eri3_batch[0] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[45];
            eri3_batch[0] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[20];
            eri3_batch[0] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[15];
            eri3_batch[1] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[11];
            eri3_batch[1] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[36];
            eri3_batch[1] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[1];
            eri3_batch[1] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[6];
            eri3_batch[1] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[46];
            eri3_batch[1] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[21];
            eri3_batch[1] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[16];
            eri3_batch[2] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[12];
            eri3_batch[2] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[37];
            eri3_batch[2] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[2];
            eri3_batch[2] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[7];
            eri3_batch[2] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[47];
            eri3_batch[2] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[22];
            eri3_batch[2] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[17];
            eri3_batch[3] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[13];
            eri3_batch[3] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[38];
            eri3_batch[3] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[3];
            eri3_batch[3] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[8];
            eri3_batch[3] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[48];
            eri3_batch[3] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[23];
            eri3_batch[3] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[18];
            eri3_batch[4] += p_ecoeffs_ab[2] * p_rints_x_ecoeffs[14];
            eri3_batch[4] += p_ecoeffs_ab[7] * p_rints_x_ecoeffs[39];
            eri3_batch[4] += p_ecoeffs_ab[0] * p_rints_x_ecoeffs[4];
            eri3_batch[4] += p_ecoeffs_ab[1] * p_rints_x_ecoeffs[9];
            eri3_batch[4] += p_ecoeffs_ab[9] * p_rints_x_ecoeffs[49];
            eri3_batch[4] += p_ecoeffs_ab[4] * p_rints_x_ecoeffs[24];
            eri3_batch[4] += p_ecoeffs_ab[3] * p_rints_x_ecoeffs[19];
            eri3_batch[5] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[5];
            eri3_batch[5] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[0];
            eri3_batch[5] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[15];
            eri3_batch[5] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[30];
            eri3_batch[6] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[6];
            eri3_batch[6] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[1];
            eri3_batch[6] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[16];
            eri3_batch[6] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[31];
            eri3_batch[7] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[7];
            eri3_batch[7] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[2];
            eri3_batch[7] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[17];
            eri3_batch[7] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[32];
            eri3_batch[8] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[8];
            eri3_batch[8] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[3];
            eri3_batch[8] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[18];
            eri3_batch[8] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[33];
            eri3_batch[9] += p_ecoeffs_ab[11] * p_rints_x_ecoeffs[9];
            eri3_batch[9] += p_ecoeffs_ab[10] * p_rints_x_ecoeffs[4];
            eri3_batch[9] += p_ecoeffs_ab[13] * p_rints_x_ecoeffs[19];
            eri3_batch[9] += p_ecoeffs_ab[16] * p_rints_x_ecoeffs[34];
            eri3_batch[10] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[0];
            eri3_batch[10] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[15];
            eri3_batch[10] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[10];
            eri3_batch[10] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[40];
            eri3_batch[11] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[1];
            eri3_batch[11] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[16];
            eri3_batch[11] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[11];
            eri3_batch[11] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[41];
            eri3_batch[12] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[2];
            eri3_batch[12] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[17];
            eri3_batch[12] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[12];
            eri3_batch[12] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[42];
            eri3_batch[13] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[3];
            eri3_batch[13] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[18];
            eri3_batch[13] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[13];
            eri3_batch[13] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[43];
            eri3_batch[14] += p_ecoeffs_ab[20] * p_rints_x_ecoeffs[4];
            eri3_batch[14] += p_ecoeffs_ab[23] * p_rints_x_ecoeffs[19];
            eri3_batch[14] += p_ecoeffs_ab[22] * p_rints_x_ecoeffs[14];
            eri3_batch[14] += p_ecoeffs_ab[28] * p_rints_x_ecoeffs[44];
            eri3_batch[15] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[10];
            eri3_batch[15] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[35];
            eri3_batch[15] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[0];
            eri3_batch[15] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[5];
            eri3_batch[15] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[20];
            eri3_batch[16] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[11];
            eri3_batch[16] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[36];
            eri3_batch[16] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[1];
            eri3_batch[16] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[6];
            eri3_batch[16] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[21];
            eri3_batch[17] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[12];
            eri3_batch[17] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[37];
            eri3_batch[17] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[2];
            eri3_batch[17] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[7];
            eri3_batch[17] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[22];
            eri3_batch[18] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[13];
            eri3_batch[18] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[38];
            eri3_batch[18] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[3];
            eri3_batch[18] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[8];
            eri3_batch[18] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[23];
            eri3_batch[19] += p_ecoeffs_ab[32] * p_rints_x_ecoeffs[14];
            eri3_batch[19] += p_ecoeffs_ab[37] * p_rints_x_ecoeffs[39];
            eri3_batch[19] += p_ecoeffs_ab[30] * p_rints_x_ecoeffs[4];
            eri3_batch[19] += p_ecoeffs_ab[31] * p_rints_x_ecoeffs[9];
            eri3_batch[19] += p_ecoeffs_ab[34] * p_rints_x_ecoeffs[24];
            eri3_batch[20] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[5];
            eri3_batch[20] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[0];
            eri3_batch[20] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[25];
            eri3_batch[20] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[10];
            eri3_batch[21] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[6];
            eri3_batch[21] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[1];
            eri3_batch[21] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[26];
            eri3_batch[21] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[11];
            eri3_batch[22] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[7];
            eri3_batch[22] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[2];
            eri3_batch[22] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[27];
            eri3_batch[22] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[12];
            eri3_batch[23] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[8];
            eri3_batch[23] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[3];
            eri3_batch[23] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[28];
            eri3_batch[23] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[13];
            eri3_batch[24] += p_ecoeffs_ab[41] * p_rints_x_ecoeffs[9];
            eri3_batch[24] += p_ecoeffs_ab[40] * p_rints_x_ecoeffs[4];
            eri3_batch[24] += p_ecoeffs_ab[45] * p_rints_x_ecoeffs[29];
            eri3_batch[24] += p_ecoeffs_ab[42] * p_rints_x_ecoeffs[14];
        }
}

template<> void lible::ints::two::eri2Kernel<2, 2>(const int cdepth_a, const int cdepth_b,
                                                   const double* exps_a, const double* exps_b,
                                                   const double* coords_a, const double* coords_b,
                                                   const double* ecoeffs_a, const double* ecoeffs_b_tsp,
                                                   double* eri2_batch)
{
    constexpr int la = 2, lb = 2;
    constexpr int lab = la + lb;
    constexpr int n_sph_a = numSphericalsC(la);
    constexpr int n_sph_b = numSphericalsC(lb);
    constexpr int n_hermite_a = numHermitesC(la);
    constexpr int n_hermite_b = numHermitesC(lb);
    constexpr int n_ecoeffs_a = n_sph_a * n_hermite_a;
    constexpr int n_ecoeffs_b = n_sph_b * n_hermite_b;

    std::fill(eri2_batch, eri2_batch + n_sph_a * n_sph_b, 0);

    std::array<double, lab + 1> fnx;
    BoysF2<lab> boys_f;

    constexpr int n_hermites_ab = numHermitesC(la) * numHermitesC(lb);
    std::array<double, n_hermites_ab> rints;

    constexpr int n_rints_x_ecoeffs = n_hermite_a * n_sph_b;
    std::vector<double> rints_x_ecoeffs(cdepth_a * n_rints_x_ecoeffs, 0);

    std::array<double, 3> xyz_ab{coords_a[0] - coords_b[0],
    coords_a[1] - coords_b[1],
    coords_a[2] - coords_b[2]};

    double dx{xyz_ab[0]}, dy{xyz_ab[1]}, dz{xyz_ab[2]};
    double xyz_ab_dot = dx * dx + dy * dy + dz * dz;	

    for (int ia = 0; ia < cdepth_a; ia++)
    {
        int pos_rints_x_ecoeffs = ia * n_rints_x_ecoeffs;
        for (int ib = 0; ib < cdepth_b; ib++)
        {
            double a = exps_a[ia];
            double b = exps_b[ib];

            double alpha = a * b / (a + b);
            double x = alpha * xyz_ab_dot;
            boys_f.calcFnx(x, &fnx[0]);

            double fac = (2.0 * std::pow(M_PI, 2.5) / (a * b * std::sqrt(a + b)));
            calcRInts<la, lb>(alpha, fac, &fnx[0], &xyz_ab[0], &rints[0]);

                    const double* p_ecoeffs_b = &ecoeffs_b_tsp[ib * n_ecoeffs_b];
                    double* p_rints_x_ecoeffs = &rints_x_ecoeffs[pos_rints_x_ecoeffs];

                    p_rints_x_ecoeffs[0] += rints[2] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[0] += rints[7] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[0] += rints[0] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[0] += rints[1] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[0] += rints[9] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[0] += rints[4] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[0] += rints[3] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[1] += rints[1] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[1] += rints[0] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[1] += rints[3] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[1] += rints[6] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[2] += rints[0] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[2] += rints[3] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[2] += rints[2] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[2] += rints[8] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[3] += rints[2] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[3] += rints[7] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[3] += rints[0] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[3] += rints[1] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[3] += rints[4] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[4] += rints[1] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[4] += rints[0] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[4] += rints[5] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[4] += rints[2] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[5] += rints[12] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[5] += rints[17] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[5] += rints[10] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[5] += rints[11] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[5] += rints[19] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[5] += rints[14] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[5] += rints[13] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[6] += rints[11] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[6] += rints[10] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[6] += rints[13] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[6] += rints[16] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[7] += rints[10] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[7] += rints[13] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[7] += rints[12] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[7] += rints[18] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[8] += rints[12] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[8] += rints[17] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[8] += rints[10] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[8] += rints[11] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[8] += rints[14] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[9] += rints[11] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[9] += rints[10] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[9] += rints[15] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[9] += rints[12] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[10] += rints[22] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[10] += rints[27] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[10] += rints[20] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[10] += rints[21] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[10] += rints[29] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[10] += rints[24] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[10] += rints[23] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[11] += rints[21] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[11] += rints[20] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[11] += rints[23] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[11] += rints[26] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[12] += rints[20] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[12] += rints[23] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[12] += rints[22] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[12] += rints[28] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[13] += rints[22] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[13] += rints[27] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[13] += rints[20] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[13] += rints[21] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[13] += rints[24] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[14] += rints[21] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[14] += rints[20] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[14] += rints[25] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[14] += rints[22] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[15] += rints[32] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[15] += rints[37] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[15] += rints[30] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[15] += rints[31] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[15] += rints[39] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[15] += rints[34] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[15] += rints[33] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[16] += rints[31] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[16] += rints[30] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[16] += rints[33] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[16] += rints[36] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[17] += rints[30] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[17] += rints[33] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[17] += rints[32] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[17] += rints[38] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[18] += rints[32] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[18] += rints[37] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[18] += rints[30] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[18] += rints[31] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[18] += rints[34] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[19] += rints[31] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[19] += rints[30] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[19] += rints[35] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[19] += rints[32] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[20] += rints[42] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[20] += rints[47] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[20] += rints[40] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[20] += rints[41] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[20] += rints[49] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[20] += rints[44] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[20] += rints[43] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[21] += rints[41] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[21] += rints[40] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[21] += rints[43] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[21] += rints[46] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[22] += rints[40] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[22] += rints[43] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[22] += rints[42] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[22] += rints[48] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[23] += rints[42] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[23] += rints[47] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[23] += rints[40] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[23] += rints[41] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[23] += rints[44] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[24] += rints[41] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[24] += rints[40] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[24] += rints[45] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[24] += rints[42] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[25] += rints[52] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[25] += rints[57] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[25] += rints[50] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[25] += rints[51] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[25] += rints[59] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[25] += rints[54] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[25] += rints[53] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[26] += rints[51] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[26] += rints[50] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[26] += rints[53] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[26] += rints[56] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[27] += rints[50] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[27] += rints[53] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[27] += rints[52] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[27] += rints[58] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[28] += rints[52] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[28] += rints[57] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[28] += rints[50] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[28] += rints[51] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[28] += rints[54] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[29] += rints[51] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[29] += rints[50] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[29] += rints[55] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[29] += rints[52] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[30] += rints[62] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[30] += rints[67] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[30] += rints[60] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[30] += rints[61] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[30] += rints[69] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[30] += rints[64] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[30] += rints[63] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[31] += rints[61] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[31] += rints[60] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[31] += rints[63] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[31] += rints[66] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[32] += rints[60] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[32] += rints[63] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[32] += rints[62] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[32] += rints[68] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[33] += rints[62] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[33] += rints[67] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[33] += rints[60] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[33] += rints[61] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[33] += rints[64] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[34] += rints[61] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[34] += rints[60] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[34] += rints[65] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[34] += rints[62] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[35] += rints[72] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[35] += rints[77] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[35] += rints[70] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[35] += rints[71] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[35] += rints[79] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[35] += rints[74] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[35] += rints[73] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[36] += rints[71] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[36] += rints[70] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[36] += rints[73] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[36] += rints[76] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[37] += rints[70] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[37] += rints[73] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[37] += rints[72] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[37] += rints[78] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[38] += rints[72] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[38] += rints[77] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[38] += rints[70] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[38] += rints[71] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[38] += rints[74] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[39] += rints[71] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[39] += rints[70] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[39] += rints[75] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[39] += rints[72] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[40] += rints[82] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[40] += rints[87] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[40] += rints[80] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[40] += rints[81] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[40] += rints[89] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[40] += rints[84] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[40] += rints[83] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[41] += rints[81] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[41] += rints[80] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[41] += rints[83] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[41] += rints[86] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[42] += rints[80] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[42] += rints[83] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[42] += rints[82] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[42] += rints[88] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[43] += rints[82] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[43] += rints[87] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[43] += rints[80] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[43] += rints[81] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[43] += rints[84] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[44] += rints[81] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[44] += rints[80] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[44] += rints[85] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[44] += rints[82] * p_ecoeffs_b[14];
                    p_rints_x_ecoeffs[45] += rints[92] * p_ecoeffs_b[10];
                    p_rints_x_ecoeffs[45] += rints[97] * p_ecoeffs_b[35];
                    p_rints_x_ecoeffs[45] += rints[90] * p_ecoeffs_b[0];
                    p_rints_x_ecoeffs[45] += rints[91] * p_ecoeffs_b[5];
                    p_rints_x_ecoeffs[45] += rints[99] * p_ecoeffs_b[45];
                    p_rints_x_ecoeffs[45] += rints[94] * p_ecoeffs_b[20];
                    p_rints_x_ecoeffs[45] += rints[93] * p_ecoeffs_b[15];
                    p_rints_x_ecoeffs[46] += rints[91] * p_ecoeffs_b[6];
                    p_rints_x_ecoeffs[46] += rints[90] * p_ecoeffs_b[1];
                    p_rints_x_ecoeffs[46] += rints[93] * p_ecoeffs_b[16];
                    p_rints_x_ecoeffs[46] += rints[96] * p_ecoeffs_b[31];
                    p_rints_x_ecoeffs[47] += rints[90] * p_ecoeffs_b[2];
                    p_rints_x_ecoeffs[47] += rints[93] * p_ecoeffs_b[17];
                    p_rints_x_ecoeffs[47] += rints[92] * p_ecoeffs_b[12];
                    p_rints_x_ecoeffs[47] += rints[98] * p_ecoeffs_b[42];
                    p_rints_x_ecoeffs[48] += rints[92] * p_ecoeffs_b[13];
                    p_rints_x_ecoeffs[48] += rints[97] * p_ecoeffs_b[38];
                    p_rints_x_ecoeffs[48] += rints[90] * p_ecoeffs_b[3];
                    p_rints_x_ecoeffs[48] += rints[91] * p_ecoeffs_b[8];
                    p_rints_x_ecoeffs[48] += rints[94] * p_ecoeffs_b[23];
                    p_rints_x_ecoeffs[49] += rints[91] * p_ecoeffs_b[9];
                    p_rints_x_ecoeffs[49] += rints[90] * p_ecoeffs_b[4];
                    p_rints_x_ecoeffs[49] += rints[95] * p_ecoeffs_b[29];
                    p_rints_x_ecoeffs[49] += rints[92] * p_ecoeffs_b[14];
        }
    }

    for (int ia = 0; ia < cdepth_a; ia++)
    {
            const double* p_ecoeffs_a = &ecoeffs_a[ia * n_ecoeffs_a];
            const double* p_rints_x_ecoeffs = &rints_x_ecoeffs[ia * n_rints_x_ecoeffs];

            eri2_batch[0] += p_ecoeffs_a[2] * p_rints_x_ecoeffs[10];
            eri2_batch[0] += p_ecoeffs_a[7] * p_rints_x_ecoeffs[35];
            eri2_batch[0] += p_ecoeffs_a[0] * p_rints_x_ecoeffs[0];
            eri2_batch[0] += p_ecoeffs_a[1] * p_rints_x_ecoeffs[5];
            eri2_batch[0] += p_ecoeffs_a[9] * p_rints_x_ecoeffs[45];
            eri2_batch[0] += p_ecoeffs_a[4] * p_rints_x_ecoeffs[20];
            eri2_batch[0] += p_ecoeffs_a[3] * p_rints_x_ecoeffs[15];
            eri2_batch[1] += p_ecoeffs_a[2] * p_rints_x_ecoeffs[11];
            eri2_batch[1] += p_ecoeffs_a[7] * p_rints_x_ecoeffs[36];
            eri2_batch[1] += p_ecoeffs_a[0] * p_rints_x_ecoeffs[1];
            eri2_batch[1] += p_ecoeffs_a[1] * p_rints_x_ecoeffs[6];
            eri2_batch[1] += p_ecoeffs_a[9] * p_rints_x_ecoeffs[46];
            eri2_batch[1] += p_ecoeffs_a[4] * p_rints_x_ecoeffs[21];
            eri2_batch[1] += p_ecoeffs_a[3] * p_rints_x_ecoeffs[16];
            eri2_batch[2] += p_ecoeffs_a[2] * p_rints_x_ecoeffs[12];
            eri2_batch[2] += p_ecoeffs_a[7] * p_rints_x_ecoeffs[37];
            eri2_batch[2] += p_ecoeffs_a[0] * p_rints_x_ecoeffs[2];
            eri2_batch[2] += p_ecoeffs_a[1] * p_rints_x_ecoeffs[7];
            eri2_batch[2] += p_ecoeffs_a[9] * p_rints_x_ecoeffs[47];
            eri2_batch[2] += p_ecoeffs_a[4] * p_rints_x_ecoeffs[22];
            eri2_batch[2] += p_ecoeffs_a[3] * p_rints_x_ecoeffs[17];
            eri2_batch[3] += p_ecoeffs_a[2] * p_rints_x_ecoeffs[13];
            eri2_batch[3] += p_ecoeffs_a[7] * p_rints_x_ecoeffs[38];
            eri2_batch[3] += p_ecoeffs_a[0] * p_rints_x_ecoeffs[3];
            eri2_batch[3] += p_ecoeffs_a[1] * p_rints_x_ecoeffs[8];
            eri2_batch[3] += p_ecoeffs_a[9] * p_rints_x_ecoeffs[48];
            eri2_batch[3] += p_ecoeffs_a[4] * p_rints_x_ecoeffs[23];
            eri2_batch[3] += p_ecoeffs_a[3] * p_rints_x_ecoeffs[18];
            eri2_batch[4] += p_ecoeffs_a[2] * p_rints_x_ecoeffs[14];
            eri2_batch[4] += p_ecoeffs_a[7] * p_rints_x_ecoeffs[39];
            eri2_batch[4] += p_ecoeffs_a[0] * p_rints_x_ecoeffs[4];
            eri2_batch[4] += p_ecoeffs_a[1] * p_rints_x_ecoeffs[9];
            eri2_batch[4] += p_ecoeffs_a[9] * p_rints_x_ecoeffs[49];
            eri2_batch[4] += p_ecoeffs_a[4] * p_rints_x_ecoeffs[24];
            eri2_batch[4] += p_ecoeffs_a[3] * p_rints_x_ecoeffs[19];
            eri2_batch[5] += p_ecoeffs_a[11] * p_rints_x_ecoeffs[5];
            eri2_batch[5] += p_ecoeffs_a[10] * p_rints_x_ecoeffs[0];
            eri2_batch[5] += p_ecoeffs_a[13] * p_rints_x_ecoeffs[15];
            eri2_batch[5] += p_ecoeffs_a[16] * p_rints_x_ecoeffs[30];
            eri2_batch[6] += p_ecoeffs_a[11] * p_rints_x_ecoeffs[6];
            eri2_batch[6] += p_ecoeffs_a[10] * p_rints_x_ecoeffs[1];
            eri2_batch[6] += p_ecoeffs_a[13] * p_rints_x_ecoeffs[16];
            eri2_batch[6] += p_ecoeffs_a[16] * p_rints_x_ecoeffs[31];
            eri2_batch[7] += p_ecoeffs_a[11] * p_rints_x_ecoeffs[7];
            eri2_batch[7] += p_ecoeffs_a[10] * p_rints_x_ecoeffs[2];
            eri2_batch[7] += p_ecoeffs_a[13] * p_rints_x_ecoeffs[17];
            eri2_batch[7] += p_ecoeffs_a[16] * p_rints_x_ecoeffs[32];
            eri2_batch[8] += p_ecoeffs_a[11] * p_rints_x_ecoeffs[8];
            eri2_batch[8] += p_ecoeffs_a[10] * p_rints_x_ecoeffs[3];
            eri2_batch[8] += p_ecoeffs_a[13] * p_rints_x_ecoeffs[18];
            eri2_batch[8] += p_ecoeffs_a[16] * p_rints_x_ecoeffs[33];
            eri2_batch[9] += p_ecoeffs_a[11] * p_rints_x_ecoeffs[9];
            eri2_batch[9] += p_ecoeffs_a[10] * p_rints_x_ecoeffs[4];
            eri2_batch[9] += p_ecoeffs_a[13] * p_rints_x_ecoeffs[19];
            eri2_batch[9] += p_ecoeffs_a[16] * p_rints_x_ecoeffs[34];
            eri2_batch[10] += p_ecoeffs_a[20] * p_rints_x_ecoeffs[0];
            eri2_batch[10] += p_ecoeffs_a[23] * p_rints_x_ecoeffs[15];
            eri2_batch[10] += p_ecoeffs_a[22] * p_rints_x_ecoeffs[10];
            eri2_batch[10] += p_ecoeffs_a[28] * p_rints_x_ecoeffs[40];
            eri2_batch[11] += p_ecoeffs_a[20] * p_rints_x_ecoeffs[1];
            eri2_batch[11] += p_ecoeffs_a[23] * p_rints_x_ecoeffs[16];
            eri2_batch[11] += p_ecoeffs_a[22] * p_rints_x_ecoeffs[11];
            eri2_batch[11] += p_ecoeffs_a[28] * p_rints_x_ecoeffs[41];
            eri2_batch[12] += p_ecoeffs_a[20] * p_rints_x_ecoeffs[2];
            eri2_batch[12] += p_ecoeffs_a[23] * p_rints_x_ecoeffs[17];
            eri2_batch[12] += p_ecoeffs_a[22] * p_rints_x_ecoeffs[12];
            eri2_batch[12] += p_ecoeffs_a[28] * p_rints_x_ecoeffs[42];
            eri2_batch[13] += p_ecoeffs_a[20] * p_rints_x_ecoeffs[3];
            eri2_batch[13] += p_ecoeffs_a[23] * p_rints_x_ecoeffs[18];
            eri2_batch[13] += p_ecoeffs_a[22] * p_rints_x_ecoeffs[13];
            eri2_batch[13] += p_ecoeffs_a[28] * p_rints_x_ecoeffs[43];
            eri2_batch[14] += p_ecoeffs_a[20] * p_rints_x_ecoeffs[4];
            eri2_batch[14] += p_ecoeffs_a[23] * p_rints_x_ecoeffs[19];
            eri2_batch[14] += p_ecoeffs_a[22] * p_rints_x_ecoeffs[14];
            eri2_batch[14] += p_ecoeffs_a[28] * p_rints_x_ecoeffs[44];
            eri2_batch[15] += p_ecoeffs_a[32] * p_rints_x_ecoeffs[10];
            eri2_batch[15] += p_ecoeffs_a[37] * p_rints_x_ecoeffs[35];
            eri2_batch[15] += p_ecoeffs_a[30] * p_rints_x_ecoeffs[0];
            eri2_batch[15] += p_ecoeffs_a[31] * p_rints_x_ecoeffs[5];
            eri2_batch[15] += p_ecoeffs_a[34] * p_rints_x_ecoeffs[20];
            eri2_batch[16] += p_ecoeffs_a[32] * p_rints_x_ecoeffs[11];
            eri2_batch[16] += p_ecoeffs_a[37] * p_rints_x_ecoeffs[36];
            eri2_batch[16] += p_ecoeffs_a[30] * p_rints_x_ecoeffs[1];
            eri2_batch[16] += p_ecoeffs_a[31] * p_rints_x_ecoeffs[6];
            eri2_batch[16] += p_ecoeffs_a[34] * p_rints_x_ecoeffs[21];
            eri2_batch[17] += p_ecoeffs_a[32] * p_rints_x_ecoeffs[12];
            eri2_batch[17] += p_ecoeffs_a[37] * p_rints_x_ecoeffs[37];
            eri2_batch[17] += p_ecoeffs_a[30] * p_rints_x_ecoeffs[2];
            eri2_batch[17] += p_ecoeffs_a[31] * p_rints_x_ecoeffs[7];
            eri2_batch[17] += p_ecoeffs_a[34] * p_rints_x_ecoeffs[22];
            eri2_batch[18] += p_ecoeffs_a[32] * p_rints_x_ecoeffs[13];
            eri2_batch[18] += p_ecoeffs_a[37] * p_rints_x_ecoeffs[38];
            eri2_batch[18] += p_ecoeffs_a[30] * p_rints_x_ecoeffs[3];
            eri2_batch[18] += p_ecoeffs_a[31] * p_rints_x_ecoeffs[8];
            eri2_batch[18] += p_ecoeffs_a[34] * p_rints_x_ecoeffs[23];
            eri2_batch[19] += p_ecoeffs_a[32] * p_rints_x_ecoeffs[14];
            eri2_batch[19] += p_ecoeffs_a[37] * p_rints_x_ecoeffs[39];
            eri2_batch[19] += p_ecoeffs_a[30] * p_rints_x_ecoeffs[4];
            eri2_batch[19] += p_ecoeffs_a[31] * p_rints_x_ecoeffs[9];
            eri2_batch[19] += p_ecoeffs_a[34] * p_rints_x_ecoeffs[24];
            eri2_batch[20] += p_ecoeffs_a[41] * p_rints_x_ecoeffs[5];
            eri2_batch[20] += p_ecoeffs_a[40] * p_rints_x_ecoeffs[0];
            eri2_batch[20] += p_ecoeffs_a[45] * p_rints_x_ecoeffs[25];
            eri2_batch[20] += p_ecoeffs_a[42] * p_rints_x_ecoeffs[10];
            eri2_batch[21] += p_ecoeffs_a[41] * p_rints_x_ecoeffs[6];
            eri2_batch[21] += p_ecoeffs_a[40] * p_rints_x_ecoeffs[1];
            eri2_batch[21] += p_ecoeffs_a[45] * p_rints_x_ecoeffs[26];
            eri2_batch[21] += p_ecoeffs_a[42] * p_rints_x_ecoeffs[11];
            eri2_batch[22] += p_ecoeffs_a[41] * p_rints_x_ecoeffs[7];
            eri2_batch[22] += p_ecoeffs_a[40] * p_rints_x_ecoeffs[2];
            eri2_batch[22] += p_ecoeffs_a[45] * p_rints_x_ecoeffs[27];
            eri2_batch[22] += p_ecoeffs_a[42] * p_rints_x_ecoeffs[12];
            eri2_batch[23] += p_ecoeffs_a[41] * p_rints_x_ecoeffs[8];
            eri2_batch[23] += p_ecoeffs_a[40] * p_rints_x_ecoeffs[3];
            eri2_batch[23] += p_ecoeffs_a[45] * p_rints_x_ecoeffs[28];
            eri2_batch[23] += p_ecoeffs_a[42] * p_rints_x_ecoeffs[13];
            eri2_batch[24] += p_ecoeffs_a[41] * p_rints_x_ecoeffs[9];
            eri2_batch[24] += p_ecoeffs_a[40] * p_rints_x_ecoeffs[4];
            eri2_batch[24] += p_ecoeffs_a[45] * p_rints_x_ecoeffs[29];
            eri2_batch[24] += p_ecoeffs_a[42] * p_rints_x_ecoeffs[14];
    }
}
