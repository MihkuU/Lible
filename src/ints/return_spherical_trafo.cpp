#include "spherical_trafo.h"

using namespace Lible;

typedef std::tuple<std::size_t, std::size_t, double> trafo_coeff_tuple;

std::vector<trafo_coeff_tuple> SphericalTrafo::returnSphericalTrafo(const int &angmom)
{
    std::vector<trafo_coeff_tuple> spherical_trafo;

    /*
     * Quick word on conventions used here:
     * The transformation from cartesian to spherical gaussian basis sets is stored
     * in a vector of tuples with three values.
     * Values in tuple:
     *   first integer - spherical gaussian index
     *   second integer - cartesian gaussian index
     *   third double - transformation coefficient
     */
    switch (angmom)
    {
    case (0):
    {
        spherical_trafo = std::vector<trafo_coeff_tuple>{
            {1, 1, 1.0}};
        break;
    }

    case (1):
    {
        spherical_trafo = std::vector<trafo_coeff_tuple>{
            {1, 3, 1.0},
            {2, 1, 1.0},
            {3, 2, 1.0}};
        break;
    }

    case (2):
    {
        spherical_trafo = std::vector<trafo_coeff_tuple>{
            {1, 6, 1.0},
            {1, 1, -0.5},
            {1, 4, -0.5},
            {2, 3, 1.7320508075688772},
            {3, 5, 1.7320508075688772},
            {4, 1, 0.8660254037844386},
            {4, 4, -0.8660254037844386},
            {5, 2, 1.7320508075688772}};
        break;
    }

    case (3):
    {
        spherical_trafo = std::vector<trafo_coeff_tuple>{
            {1, 10, 1.0},
            {1, 3, -1.5},
            {1, 8, -1.5},
            {2, 6, 2.449489742783178},
            {2, 1, -0.6123724356957945},
            {2, 4, -0.6123724356957945},
            {3, 9, 2.449489742783178},
            {3, 2, -0.6123724356957945},
            {3, 7, -0.6123724356957945},
            {4, 3, 1.9364916731037085},
            {4, 8, -1.9364916731037085},
            {5, 5, 3.872983346207417},
            {6, 1, 0.7905694150420948},
            {6, 4, -2.3717082451262845},
            {7, 2, 2.3717082451262845},
            {7, 7, -0.7905694150420948}};
        break;
    }

    case (4):
    {
        spherical_trafo = std::vector<trafo_coeff_tuple>{
            {1, 15, 1.0},
            {1, 6, -3.0},
            {1, 13, -3.0},
            {1, 1, 0.375},
            {1, 4, 0.75},
            {1, 11, 0.375},
            {2, 10, 3.162277660168379},
            {2, 3, -2.3717082451262845},
            {2, 8, -2.3717082451262845},
            {3, 14, 3.162277660168379},
            {3, 5, -2.3717082451262845},
            {3, 12, -2.3717082451262845},
            {4, 6, 3.3541019662496847},
            {4, 13, -3.3541019662496847},
            {4, 1, -0.5590169943749475},
            {4, 4, 0.5590169943749475},
            {4, 4, -0.5590169943749475},
            {4, 11, 0.5590169943749475},
            {5, 9, 6.708203932499369},
            {5, 2, -1.118033988749895},
            {5, 7, -1.118033988749895},
            {6, 3, 2.0916500663351885},
            {6, 8, -6.274950199005565},
            {7, 5, 6.274950199005565},
            {7, 12, -2.0916500663351885},
            {8, 1, 0.739509972887452},
            {8, 4, -4.437059837324712},
            {8, 11, 0.739509972887452},
            {9, 2, 2.958039891549808},
            {9, 7, -2.958039891549808}};
        break;
    }

    case (5):
    {
        spherical_trafo = std::vector<trafo_coeff_tuple>{
            {1, 21, 1.0},
            {1, 10, -5.0},
            {1, 19, -5.0},
            {1, 3, 1.875},
            {1, 8, 3.75},
            {1, 17, 1.875},
            {2, 15, 3.8729833462074166},
            {2, 6, -5.809475019311125},
            {2, 13, -5.809475019311125},
            {2, 1, 0.4841229182759271},
            {2, 4, 0.9682458365518541},
            {2, 11, 0.4841229182759271},
            {3, 20, 3.8729833462074166},
            {3, 9, -5.809475019311125},
            {3, 18, -5.809475019311125},
            {3, 2, 0.4841229182759271},
            {3, 7, 0.9682458365518541},
            {3, 16, 0.4841229182759271},
            {4, 10, 5.1234753829798},
            {4, 19, -5.1234753829798},
            {4, 3, -2.5617376914899},
            {4, 8, 2.5617376914899},
            {4, 8, -2.5617376914899},
            {4, 17, 2.5617376914899},
            {5, 14, 10.2469507659596},
            {5, 5, -5.1234753829798},
            {5, 12, -5.1234753829798},
            {6, 6, 4.183300132670377},
            {6, 13, -12.549900398011133},
            {6, 1, -0.5229125165837971},
            {6, 4, 1.5687375497513916},
            {6, 4, -0.5229125165837971},
            {6, 11, 1.5687375497513916},
            {7, 9, 12.549900398011133},
            {7, 18, -4.183300132670377},
            {7, 2, -1.5687375497513916},
            {7, 7, 0.5229125165837971},
            {7, 7, -1.5687375497513916},
            {7, 16, 0.5229125165837971},
            {8, 3, 2.218529918662356},
            {8, 8, -13.311179511974137},
            {8, 17, 2.218529918662356},
            {9, 5, 8.874119674649425},
            {9, 12, -8.874119674649425},
            {10, 1, 0.7015607600201139},
            {10, 4, -7.01560760020114},
            {10, 11, 3.50780380010057},
            {11, 2, 3.50780380010057},
            {11, 7, -7.01560760020114},
            {11, 16, 0.7015607600201139}};
        break;
    }

    case (6):
    {
        spherical_trafo = std::vector<trafo_coeff_tuple>{
            {1, 28, 1.0},
            {1, 15, -7.5},
            {1, 26, -7.5},
            {1, 6, 5.625},
            {1, 13, 11.25},
            {1, 24, 5.625},
            {1, 1, -0.3125},
            {1, 4, -0.9375},
            {1, 11, -0.9375},
            {1, 22, -0.3125},
            {2, 21, 4.582575694955841},
            {2, 10, -11.456439237389601},
            {2, 19, -11.456439237389601},
            {2, 3, 2.8641098093474002},
            {2, 8, 5.7282196186948005},
            {2, 17, 2.8641098093474002},
            {3, 27, 4.582575694955841},
            {3, 14, -11.456439237389601},
            {3, 25, -11.456439237389601},
            {3, 5, 2.8641098093474002},
            {3, 12, 5.7282196186948005},
            {3, 23, 2.8641098093474002},
            {4, 15, 7.245688373094719},
            {4, 26, -7.245688373094719},
            {4, 6, -7.245688373094719},
            {4, 13, 7.245688373094719},
            {4, 13, -7.245688373094719},
            {4, 24, 7.245688373094719},
            {4, 1, 0.4528555233184199},
            {4, 4, -0.4528555233184199},
            {4, 4, 0.9057110466368399},
            {4, 11, -0.9057110466368399},
            {4, 11, 0.4528555233184199},
            {4, 22, -0.4528555233184199},
            {5, 20, 14.491376746189438},
            {5, 9, -14.491376746189438},
            {5, 18, -14.491376746189438},
            {5, 2, 0.9057110466368399},
            {5, 7, 1.8114220932736798},
            {5, 16, 0.9057110466368399},
            {6, 10, 7.24568837309472},
            {6, 19, -21.73706511928416},
            {6, 3, -2.71713313991052},
            {6, 8, 8.15139941973156},
            {6, 8, -2.71713313991052},
            {6, 17, 8.15139941973156},
            {7, 14, 21.73706511928416},
            {7, 25, -7.24568837309472},
            {7, 5, -8.15139941973156},
            {7, 12, 2.71713313991052},
            {7, 12, -8.15139941973156},
            {7, 23, 2.71713313991052},
            {8, 6, 4.960783708246107},
            {8, 13, -29.764702249476645},
            {8, 24, 4.960783708246107},
            {8, 1, -0.4960783708246108},
            {8, 4, 2.9764702249476644},
            {8, 11, -0.4960783708246108},
            {8, 4, -0.4960783708246108},
            {8, 11, 2.9764702249476644},
            {8, 22, -0.4960783708246108},
            {9, 9, 19.84313483298443},
            {9, 18, -19.84313483298443},
            {9, 2, -1.984313483298443},
            {9, 7, 1.984313483298443},
            {9, 7, -1.984313483298443},
            {9, 16, 1.984313483298443},
            {10, 3, 2.3268138086232857},
            {10, 8, -23.268138086232856},
            {10, 17, 11.634069043116428},
            {11, 5, 11.634069043116428},
            {11, 12, -23.268138086232856},
            {11, 23, 2.3268138086232857},
            {12, 1, 0.6716932893813962},
            {12, 4, -10.075399340720942},
            {12, 11, 10.075399340720942},
            {12, 22, -0.6716932893813962},
            {13, 2, 4.030159736288377},
            {13, 7, -13.433865787627923},
            {13, 16, 4.030159736288377}};
        break;
    }
    }

    return spherical_trafo;
}